import{p as ve,r as Ea,b as ki,i as Xi,_ as At}from"../chunks/Dawefqck.js";import{f as De,d as ce,j as Gi,l as Yi,m as Pi,c as lr,t as da}from"../chunks/DgLr_n3f.js";import{a as ca,o as ka}from"../chunks/o1K7PoLX.js";import{a as Mi,w as ur,G as vi,h as Re,R as fr,x as dr,k as u,an as cr,ae as hr,H as pr,J as ha,V as gi,e as zt,C as mr,$ as vr,F as pa,c as rt,b as Ai,s as gr,aw as wr,n as zi,Y as Pa,aH as yr,aV as Ma,r as Aa,p as br,aW as za,aX as _r,aY as wi,T as Cr,aZ as xr,a_ as Sr,X as Tr,d as Er,t as Oa,a$ as Ia,b0 as kr,v as Pr,M as Mr,b1 as Ar,aF as zr,af as Ra,i as xt,b2 as Or,aB as Da,b3 as Ir,b4 as Ge,aK as Fa,o as La,ay as Oi,aL as Rr,aA as Dr,ax as se,b5 as ma,al as V,q as ct,b6 as Fr,ak as Dt,az as Ft,b7 as Lr,u as Lt,b8 as Ii,_ as St,a3 as ut,a1 as Tt,ad as w,ab as B,ac as L,b9 as Ba,a4 as ze}from"../chunks/CZU2CgIK.js";import{a as Br,s as Wa}from"../chunks/CbEGHjZ_.js";import{b as Wr,c as Bt,s as Ua,S as Ur,a as x,r as ee,d as va}from"../chunks/CLVlXtA6.js";function Ri(e,t){return t}function Nr(e,t,i){for(var a=[],r=t.length,s=0;s<r;s++)xr(t[s].e,a,!0);Sr(a,()=>{var l=a.length===0&&i!==null;if(l){var o=i,f=o.parentNode;Tr(f),f.append(o),e.items.clear(),Se(e,t[0].prev,t[r-1].next)}for(var d=0;d<r;d++){var c=t[d];l||(e.items.delete(c.k),Se(e,c.prev,c.next)),Er(c.e,!l)}e.first===t[0]&&(e.first=t[0].prev)})}function Di(e,t,i,a,r,s=null){var l=e,o=new Map,f=null,d=(t&Ia)!==0,c=(t&za)!==0,C=(t&Ma)!==0;if(d){var _=e;l=Re?vi(fr(_)):_.appendChild(Mi())}Re&&dr();var y=null,k=cr(()=>{var F=i();return yr(F)?F:F==null?[]:Pa(F)}),p,h=!0;function M(){jr(Y,p,l,t,a),y!==null&&(p.length===0?(y.fragment?(l.before(y.fragment),y.fragment=null):Aa(y.effect),G.first=y.effect):br(y.effect,()=>{y=null}))}var G=ur(()=>{p=u(k);var F=p.length;let K=!1;if(Re){var re=hr(l)===pr;re!==(F===0)&&(l=ha(),vi(l),gi(!1),K=!0)}for(var R=new Set,oe=rt,ie=null,Ie=gr(),be=0;be<F;be+=1){Re&&zt.nodeType===mr&&zt.data===vr&&(l=zt,K=!0,gi(!1));var z=p[be],m=a(z,be),S=h?null:o.get(m);S?(c&&pa(S.v,z),C?pa(S.i,be):S.i=be,Ie&&oe.skipped_effects.delete(S.e)):(S=Vr(h?l:null,ie,z,m,be,r,t,i),h&&(S.o=!0,ie===null?f=S:ie.next=S,ie=S),o.set(m,S)),R.add(m)}if(F===0&&s&&!y)if(h)y={fragment:null,effect:Ai(()=>s(l))};else{var E=document.createDocumentFragment(),U=Mi();E.append(U),y={fragment:E,effect:Ai(()=>s(U))}}if(Re&&F>0&&vi(ha()),!h)if(Ie){for(const[J,Q]of o)R.has(J)||oe.skipped_effects.add(Q.e);oe.oncommit(M),oe.ondiscard(()=>{})}else M();K&&gi(!0),u(k)}),Y={effect:G,items:o,first:f};h=!1,Re&&(l=zt)}function jr(e,t,i,a,r){var s=(a&kr)!==0,l=t.length,o=e.items,f=e.first,d,c=null,C,_=[],y=[],k,p,h,M;if(s)for(M=0;M<l;M+=1)k=t[M],p=r(k,M),h=o.get(p),h.a?.measure(),(C??=new Set).add(h);for(M=0;M<l;M+=1){if(k=t[M],p=r(k,M),h=o.get(p),e.first??=h,!h.o){h.o=!0;var G=c?c.next:f;Se(e,c,h),Se(e,h,G),yi(h,G,i),c=h,_=[],y=[],f=c.next;continue}if((h.e.f&wi)!==0&&(Aa(h.e),s&&(h.a?.unfix(),(C??=new Set).delete(h))),h!==f){if(d!==void 0&&d.has(h)){if(_.length<y.length){var Y=y[0],F;c=Y.prev;var K=_[0],re=_[_.length-1];for(F=0;F<_.length;F+=1)yi(_[F],Y,i);for(F=0;F<y.length;F+=1)d.delete(y[F]);Se(e,K.prev,re.next),Se(e,c,K),Se(e,re,Y),f=Y,c=re,M-=1,_=[],y=[]}else d.delete(h),yi(h,f,i),Se(e,h.prev,h.next),Se(e,h,c===null?e.first:c.next),Se(e,c,h),c=h;continue}for(_=[],y=[];f!==null&&f.k!==p;)(f.e.f&wi)===0&&(d??=new Set).add(f),y.push(f),f=f.next;if(f===null)continue;h=f}_.push(h),c=h,f=h.next}if(f!==null||d!==void 0){for(var R=d===void 0?[]:Pa(d);f!==null;)(f.e.f&wi)===0&&R.push(f),f=f.next;var oe=R.length;if(oe>0){var ie=(a&Ia)!==0&&l===0?i:null;if(s){for(M=0;M<oe;M+=1)R[M].a?.measure();for(M=0;M<oe;M+=1)R[M].a?.fix()}Nr(e,R,ie)}}s&&Oa(()=>{if(C!==void 0)for(h of C)h.a?.apply()})}function Vr(e,t,i,a,r,s,l,o){var f=(l&za)!==0,d=(l&_r)===0,c=f?d?wr(i,!1,!1):zi(i):i,C=(l&Ma)===0?r:zi(r),_={i:C,v:c,k:a,a:null,e:null,o:!1,prev:t,next:null};try{if(e===null){var y=document.createDocumentFragment();y.append(e=Mi())}return _.e=Ai(()=>s(e,c,C,o)),t!==null&&(t.next=_),_}finally{}}function yi(e,t,i){for(var a=e.next?e.next.e.nodes_start:i,r=t?t.e.nodes_start:i,s=e.e.nodes_start;s!==null&&s!==a;){var l=Cr(s);r.before(s),s=l}}function Se(e,t,i){t===null?(e.first=i,e.effect.first=i&&i.e):(t.e.next&&(t.e.next.prev=null),t.next=i,t.e.next=i&&i.e),i===null?e.effect.last=t&&t.e:(i.e.prev&&(i.e.prev.next=null),i.prev=t,i.e.prev=t&&t.e)}const $r=()=>performance.now(),Ae={tick:e=>requestAnimationFrame(e),now:()=>$r(),tasks:new Set};function Na(){const e=Ae.now();Ae.tasks.forEach(t=>{t.c(e)||(Ae.tasks.delete(t),t.f())}),Ae.tasks.size!==0&&Ae.tick(Na)}function Hr(e){let t;return Ae.tasks.size===0&&Ae.tick(Na),{promise:new Promise(i=>{Ae.tasks.add(t={c:e,f:i})}),abort(){Ae.tasks.delete(t)}}}function Ot(e,t){Da(()=>{e.dispatchEvent(new CustomEvent(t))})}function qr(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(i=>i[0].toUpperCase()+i.slice(1)).join("")}function ga(e){const t={},i=e.split(";");for(const a of i){const[r,s]=a.split(":");if(!r||s===void 0)break;const l=qr(r.trim());t[l]=s.trim()}return t}const Xr=e=>e;function wa(e,t,i,a){var r=(e&Or)!==0,s="both",l,o=t.inert,f=t.style.overflow,d,c;function C(){return Da(()=>l??=i()(t,a?.()??{},{direction:s}))}var _={is_global:r,in(){t.inert=o,Ot(t,"introstart"),d=Fi(t,C(),c,1,()=>{Ot(t,"introend"),d?.abort(),d=l=void 0,t.style.overflow=f})},out(h){t.inert=!0,Ot(t,"outrostart"),c=Fi(t,C(),d,0,()=>{Ot(t,"outroend"),h?.()})},stop:()=>{d?.abort(),c?.abort()}},y=Pr;if((y.transitions??=[]).push(_),Br){var k=r;if(!k){for(var p=y.parent;p&&(p.f&Mr)!==0;)for(;(p=p.parent)&&(p.f&Ar)===0;);k=!p||(p.f&zr)!==0}k&&Ra(()=>{xt(()=>_.in())})}}function Fi(e,t,i,a,r){var s=a===1;if(Ir(t)){var l,o=!1;return Oa(()=>{if(!o){var h=t({direction:s?"in":"out"});l=Fi(e,h,i,a,r)}}),{abort:()=>{o=!0,l?.abort()},deactivate:()=>l.deactivate(),reset:()=>l.reset(),t:()=>l.t()}}if(i?.deactivate(),!t?.duration)return r(),{abort:Ge,deactivate:Ge,reset:Ge,t:()=>a};const{delay:f=0,css:d,tick:c,easing:C=Xr}=t;var _=[];if(s&&i===void 0&&(c&&c(0,1),d)){var y=ga(d(0,1));_.push(y,y)}var k=()=>1-a,p=e.animate(_,{duration:f,fill:"forwards"});return p.onfinish=()=>{p.cancel();var h=i?.t()??1-a;i?.abort();var M=a-h,G=t.duration*Math.abs(M),Y=[];if(G>0){var F=!1;if(d)for(var K=Math.ceil(G/16.666666666666668),re=0;re<=K;re+=1){var R=h+M*C(re/K),oe=ga(d(R,1-R));Y.push(oe),F||=oe.overflow==="hidden"}F&&(e.style.overflow="hidden"),k=()=>{var ie=p.currentTime;return h+M*C(ie/G)},c&&Hr(()=>{if(p.playState!=="running")return!1;var ie=k();return c(ie,1-ie),!0})}p=e.animate(Y,{duration:G,fill:"forwards"}),p.onfinish=()=>{k=()=>a,c?.(a,1-a),r()}},{abort:()=>{p&&(p.cancel(),p.effect=null,p.onfinish=Ge)},deactivate:()=>{r=Ge},reset:()=>{a===0&&c?.(1,0)},t:()=>k()}}function te(e,t,i=t){var a=new WeakSet;Fa(e,"input",async r=>{var s=r?e.defaultValue:e.value;if(s=bi(e)?_i(s):s,i(s),rt!==null&&a.add(rt),await Oi(),s!==(s=t())){var l=e.selectionStart,o=e.selectionEnd,f=e.value.length;if(e.value=s??"",o!==null){var d=e.value.length;l===o&&o===f&&d>f?(e.selectionStart=d,e.selectionEnd=d):(e.selectionStart=l,e.selectionEnd=Math.min(o,d))}}}),(Re&&e.defaultValue!==e.value||xt(t)==null&&e.value)&&(i(bi(e)?_i(e.value):e.value),rt!==null&&a.add(rt)),La(()=>{var r=t();if(e===document.activeElement){var s=Rr??rt;if(a.has(s))return}bi(e)&&r===_i(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Gr(e,t,i=t){Fa(e,"change",a=>{var r=a?e.defaultChecked:e.checked;i(r)}),(Re&&e.defaultChecked!==e.checked||xt(t)==null)&&i(e.checked),La(()=>{var a=t();e.checked=!!a})}function bi(e){var t=e.type;return t==="number"||t==="range"}function _i(e){return e===""?null:+e}class Ki{#e=new WeakMap;#t;#i;static entries=new WeakMap;constructor(t){this.#i=t}observe(t,i){var a=this.#e.get(t)||new Set;return a.add(i),this.#e.set(t,a),this.#s().observe(t,this.#i),()=>{var r=this.#e.get(t);r.delete(i),r.size===0&&(this.#e.delete(t),this.#t.unobserve(t))}}#s(){return this.#t??(this.#t=new ResizeObserver(t=>{for(var i of t){Ki.entries.set(i.target,i);for(var a of this.#e.get(i.target)||[])a(i)}}))}}var Yr=new Ki({box:"border-box"});function ya(e,t,i){var a=Yr.observe(e,()=>i(e[t]));Ra(()=>(xt(()=>i(e[t])),a))}function Kr(e,t,i,a,r){var s=()=>{a(i[e])};i.addEventListener(t,s),s(),(i===document.body||i===window||i===document)&&Dr(()=>{i.removeEventListener(t,s)})}const Jr=e=>{const t=e*2,i=t>>16&255,a=t>>8&255,r=t&255;return[i,a,r]},Zr=([e,t,i])=>{const a=(e<<16|t<<8|i)/2;return a%1?0:a},Qr=["filter","shadowBlur","globalCompositeOperation","globalAlpha","fillStyle","strokeStyle"],en=(e,t,{rgbToId:i=Zr,idToRgb:a=Jr}={})=>{const r=e.getContext("2d",t),s=new OffscreenCanvas(e.width,e.height),l=s.getContext("2d",{willReadFrequently:!1,alpha:!1});return new Proxy(r,{get(o,f){const{width:d,height:c}=e;if((d!==s.width||c!==s.height)&&(s.width=d,s.height=c),f==="getLayerIdAt")return(_,y)=>{const[k,p,h]=l.getImageData(_,y,1,1).data;return i([k,p,h])};if(f==="setCurrentLayerId")return _=>{const[y,k,p]=a(_),h=`rgb(${y},${k},${p})`;l.fillStyle=h,l.strokeStyle=h};const C=o[f];return typeof C!="function"?C:(..._)=>{let y=f,k=_;return f==="drawImage"&&(y="fillRect",k=_.slice(-4)),l[y](...k),Reflect.apply(C,o,_)}},set(o,f,d){return o[f]=d,Qr.includes(f)||(l[f]=d),!0}})};class Ci extends Map{#e=new Map;#t=se(0);#i=se(0);#s=ma||-1;constructor(t){if(super(),t){for(var[i,a]of t)super.set(i,a);this.#i.v=super.size}}#r(t){return ma===this.#s?se(t):zi(t)}has(t){var i=this.#e,a=i.get(t);if(a===void 0){var r=super.get(t);if(r!==void 0)a=this.#r(0),i.set(t,a);else return u(this.#t),!1}return u(a),!0}forEach(t,i){this.#n(),super.forEach(t,i)}get(t){var i=this.#e,a=i.get(t);if(a===void 0){var r=super.get(t);if(r!==void 0)a=this.#r(0),i.set(t,a);else{u(this.#t);return}}return u(a),super.get(t)}set(t,i){var a=this.#e,r=a.get(t),s=super.get(t),l=super.set(t,i),o=this.#t;if(r===void 0)r=this.#r(0),a.set(t,r),V(this.#i,super.size),ct(o);else if(s!==i){ct(r);var f=o.reactions===null?null:new Set(o.reactions),d=f===null||!r.reactions?.every(c=>f.has(c));d&&ct(o)}return l}delete(t){var i=this.#e,a=i.get(t),r=super.delete(t);return a!==void 0&&(i.delete(t),V(this.#i,super.size),V(a,-1),ct(this.#t)),r}clear(){if(super.size!==0){super.clear();var t=this.#e;V(this.#i,0);for(var i of t.values())V(i,-1);ct(this.#t),t.clear()}}#n(){u(this.#t);var t=this.#e;if(this.#i.v!==t.size){for(var i of super.keys())if(!t.has(i)){var a=this.#r(0);t.set(i,a)}}for([,a]of this.#e)u(a)}keys(){return u(this.#t),super.keys()}values(){return this.#n(),super.values()}entries(){return this.#n(),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return u(this.#i),super.size}}const tn=e=>{if(window.TouchEvent&&e instanceof TouchEvent){const{left:a,top:r}=e.target.getBoundingClientRect(),{clientX:s,clientY:l}=e.changedTouches[0];return{x:s-a,y:l-r}}const{offsetX:t,offsetY:i}=e;return{x:t,y:i}},ba=(e,t)=>{e instanceof MouseEvent&&(e.target?.dispatchEvent(new PointerEvent(`layer.pointer${t}`,e)),e.target?.dispatchEvent(new MouseEvent(`layer.mouse${t}`,e)))},an=["onclick","oncontextmenu","ondblclick","onauxclick","onmousedown","onmouseenter","onmouseleave","onmouseup","onmousemove","onwheel","ontouchstart","ontouchcancel","ontouchend","ontouchmove","onpointerenter","onpointerleave","onpointerdown","onpointerup","onpointermove","onpointercancel","onlayer.mouseenter","onlayer.mouseleave","onlayer.pointerenter","onlayer.pointerleave","onfocus","onblur","onfullscreenchange","onfullscreenerror","onscroll","oncut","oncopy","onpaste","onkeydown","onkeypress","onkeyup","onmouseover","onmouseout","onselect","ondrag","ondragend","ondragenter","ondragstart","ondragleave","ondragover","ondrop","onpointerover","onpointerout","ongotpointercapture","onlostpointercapture"],rn=e=>console.warn("[svelte-canvas] %s",e),ja=Symbol("register"),nn=e=>Fr(ja)(e);class sn{#e=new Ci;#t=new Ci;#i=new Ci;#s=1;#r=Date.now();#n=se(0);#o;#a;#l;#u;#d=se(Dt([]));#f=se(0);#c=Ft(()=>this.#i.get(u(this.#f)));constructor(t){this.#a=t,Lr(ja,this.register.bind(this))}init(t,i){this.#o=t,this.#g(i),Lt(()=>this.#h()),Lt(()=>this.#v()),Lt(()=>(u(this.#n),this.#w())),ca(()=>this.#y())}redraw(){Ii(this.#n)}register({setup:t,render:i,...a}){const r=this.#p();return t&&this.#e.set(r,t),this.#t.set(r,i),Object.keys(a).length&&(this.#a.layerEvents?this.#i.set(r,a):rn("Canvas must have layerEvents={true} in order to use layer-level event handlers")),ca(()=>this.#m(r)),r}#p(){return this.#s++}#m(t){this.#t.delete(t),this.#i.delete(t)}#v(){const{onresize:t,width:i,height:a,pixelRatio:r}=this.#a;t?.({width:i,height:a,pixelRatio:r})}#g(t){const i=()=>{const a=[...t.children];V(this.#d,a.map(r=>+r.dataset.layerId),!0)};this.#u=new MutationObserver(()=>i()),this.#u.observe(t,{childList:!0}),i()}#h(){this.#a.autoplay?(xt(()=>this.redraw()),this.#l=requestAnimationFrame(()=>this.#h())):cancelAnimationFrame(this.#l)}#w(){const t=this.#o,{width:i,height:a,pixelRatio:r,autoclear:s}=this.#a,l=Date.now()-this.#r,o={context:t,width:i,height:a,time:l};t.setTransform(r,0,0,r,0,0),s&&t.clearRect(0,0,i,a);for(const[f,d]of this.#e)d(o),this.#e.delete(f);for(const f of u(this.#d))this.#o.setCurrentLayerId?.(f),this.#t.get(f)?.(o)}createEventHandlers(){const t=r=>{const s=`on${r.type}`,l=this.#a.handlers[s];l?.(r)},i=r=>{const{pixelRatio:s}=this.#a,{x:l,y:o}=tn(r);if(["touchstart","pointermove"].includes(r.type)){const c=this.#o.getLayerIdAt(l*s,o*s);u(this.#f)!==c&&(ba(r,"leave"),V(this.#f,c,!0),ba(r,"enter"))}if(!u(this.#c))return;const f=`on${r.type.replace("layer.","")}`,d=u(this.#c)[f];d?.({x:l,y:o,originalEvent:r})},a=r=>{t(r),this.#a.layerEvents&&i(r)};return an.reduce((r,s)=>({...r,[s]:a}),{})}#y(){typeof window>"u"||(this.#u?.disconnect(),cancelAnimationFrame(this.#l))}}function on(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,r,s,l,o=[],f=!0,d=!1;try{if(s=(i=i.call(e)).next,t===0){if(Object(i)!==i)return;f=!1}else for(;!(f=(a=s.call(i)).done)&&(o.push(a.value),o.length!==t);f=!0);}catch(c){d=!0,r=c}finally{try{if(!f&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(d)throw r}}return o}}function _a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),i.push.apply(i,a)}return i}function pe(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?_a(Object(i),!0).forEach((function(a){ln(e,a,i[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_a(Object(i)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))}))}return e}function ln(e,t,i){return t=gn(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function un(e,t){if(e==null)return{};var i={},a=Object.keys(e),r,s;for(s=0;s<a.length;s++)r=a[s],!(t.indexOf(r)>=0)&&(i[r]=e[r]);return i}function fn(e,t){if(e==null)return{};var i=un(e,t),a,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function Ca(e,t){return cn(e)||on(e,t)||Va(e,t)||mn()}function It(e){return dn(e)||hn(e)||Va(e)||pn()}function dn(e){if(Array.isArray(e))return Li(e)}function cn(e){if(Array.isArray(e))return e}function hn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Va(e,t){if(e){if(typeof e=="string")return Li(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Li(e,t)}}function Li(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function pn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vn(e,t){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gn(e){var t=vn(e,"string");return typeof t=="symbol"?t:String(t)}function vt(e){var t=e.sizes.shift(),i=Math.max(Math.ceil(t[0]),1),a=Math.max(Math.ceil(t[1]),1),r=[i-1,a-1,1,1],s=Date.now(),l=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,o,f;l?(o=new OffscreenCanvas(1,1),f=new OffscreenCanvas(i,a)):(o=document.createElement("canvas"),o.width=1,o.height=1,f=document.createElement("canvas"),f.width=i,f.height=a);var d=o.getContext("2d"),c=f.getContext("2d");c&&(c.fillRect.apply(c,r),d.drawImage(f,i-1,a-1,1,1,0,0,1,1));var C=d&&d.getImageData(0,0,1,1).data[3]!==0,_=Date.now()-s;return[o,f].forEach((function(y){y.height=0,y.width=0})),l?(postMessage({width:i,height:a,benchmark:_,isTestPass:C}),!C&&e.sizes.length&&vt(e)):C?e.onSuccess(i,a,_):(e.onError(i,a,_),e.sizes.length&&vt(e)),C}var xi={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},wn=["onError","onSuccess"],st={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},ht={};function Si(e){var t=e.width===e.height,i=e.height===1,a=e.width===1,r=[];if(!e.width||!e.height)e.sizes.forEach((function(c){var C=t||i?c:1,_=t||a?c:1;r.push([C,_])}));else for(var s=e.min||st.min,l=e.step||st.step,o=Math.max(e.width,e.height);o>=s;){var f=t||i?o:1,d=t||a?o:1;r.push([f,d]),o-=l}return r}function Rt(e){var t=window&&"HTMLCanvasElement"in window,i=window&&"OffscreenCanvas"in window,a=Date.now(),r=e.onError,s=e.onSuccess,l=fn(e,wn),o=null;if(!t)return!1;if(e.useWorker&&i){var f=`
            var canvasTest = `.concat(vt.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),d=new Blob([f],{type:"application/javascript"}),c=URL.createObjectURL(d);o=new Worker(c),URL.revokeObjectURL(c),o.onmessage=function(C){var _=C.data,y=_.width,k=_.height,p=_.benchmark,h=_.isTestPass;h?(ht[a].onSuccess(y,k,p),delete ht[a]):ht[a].onError(y,k,p)}}if(e.usePromise)return new Promise((function(C,_){var y=pe(pe({},e),{},{onError:function(M,G,Y){var F;if(e.sizes.length===0)F=!0;else{var K=e.sizes.slice(-1),re=Ca(K,1),R=Ca(re[0],2),oe=R[0],ie=R[1];F=M===oe&&G===ie}r(M,G,Y),F&&_({width:M,height:G,benchmark:Y})},onSuccess:function(M,G,Y){s(M,G,Y),C({width:M,height:G,benchmark:Y})}});if(o){var k=y.onError,p=y.onSuccess;ht[a]={onError:k,onSuccess:p},o.postMessage(l)}else vt(y)}));if(o)ht[a]={onError:r,onSuccess:s},o.postMessage(l);else return vt(e)}var yn={maxArea:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=Si({width:t.max,height:t.max,min:t.min,step:t.step,sizes:It(xi.area)}),a=pe(pe(pe({},st),t),{},{sizes:i});return Rt(a)},maxHeight:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=Si({width:1,height:t.max,min:t.min,step:t.step,sizes:It(xi.height)}),a=pe(pe(pe({},st),t),{},{sizes:i});return Rt(a)},maxWidth:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=Si({width:t.max,height:1,min:t.min,step:t.step,sizes:It(xi.width)}),a=pe(pe(pe({},st),t),{},{sizes:i});return Rt(a)},test:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=pe(pe({},st),t);return i.sizes=It(i.sizes),i.width&&i.height&&(i.sizes=[[i.width,i.height]]),Rt(i)}};const bn=(e,t,i,a=.1)=>{if(typeof window>"u")return i;for(;!yn.test({sizes:[[e*i,t*i]]});)i-=a;return i};var _n=De("<canvas></canvas> <div><!></div>",1);function Cn(e,t){St(t,!0);let i=ve(t,"style",3,""),a=ve(t,"autoplay",3,!1),r=ve(t,"autoclear",3,!0),s=ve(t,"layerEvents",3,!1),l=Ea(t,["$$slots","$$events","$$legacy","width","height","pixelRatio","class","style","autoplay","autoclear","layerEvents","onresize","contextSettings","children"]),o,f,d,c=se(2),C=se(0),_=se(0);const y=Ft(()=>t.width??u(C)),k=Ft(()=>t.height??u(_)),p=Ft(()=>u(c)&&t.pixelRatio==="auto"?bn(u(y),u(k),u(c)):t.pixelRatio&&t.pixelRatio!=="auto"?t.pixelRatio:u(c)),h=new sn({get width(){return u(y)},get height(){return u(k)},get pixelRatio(){return u(p)},get autoplay(){return a()},get autoclear(){return r()},get layerEvents(){return s()},get onresize(){return t.onresize},handlers:l});ka(()=>{s()?f=en(o,t.contextSettings):f=o.getContext("2d",t.contextSettings),h.init(f,d)});var G={redraw:()=>h.redraw(),get canvas(){return o},set canvas(R){o=R},get context(){return f},set context(R){f=R}},Y=_n(),F=ut(Y);Wr(F,R=>({class:t.class,width:u(y)*u(p),height:u(k)*u(p),style:i(),...R,[Ur]:{width:t.width?`${t.width}px`:"100%",height:t.height?`${t.height}px`:"100%"}}),[()=>h.createEventHandlers()]),ki(F,R=>o=R,()=>o);var K=w(F,2);Bt(K,"",{},{display:"none"});var re=B(K);return Ua(re,()=>t.children??Ge),L(K),ki(K,R=>d=R,()=>d),Kr("devicePixelRatio","resize",Ba,R=>V(c,R,!0)),ya(F,"clientWidth",R=>V(C,R)),ya(F,"clientHeight",R=>V(_,R)),ce(e,Y),Tt(G)}var xn=De("<div></div>");function Sn(e,t){St(t,!0);const i=Ea(t,["$$slots","$$events","$$legacy"]),a=nn(i);var r=xn();ze(()=>x(r,"data-layer-id",a)),ce(e,r),Tt()}function N(e){e!=null?this.seed(e):this.randomize()}N.prototype={};N.seed=N.prototype.seed=function(e){if(e==null)return this._seed;this._seed=e;let t=e|0;t^=t>>>16,t=Math.imul(t,2246822507),t^=t>>>13,t=Math.imul(t,3266489909),t^=t>>>16;const i=t&65535|1;return this._mw=i,this._mz=123456789,e};N.randomize=N.prototype.randomize=function(){return this.seed(1+Math.floor(Math.random()*4294967295))};N.getState=N.prototype.getState=function(){return{seed:this._seed,mz:this._mz,mw:this._mw}};N.setState=N.prototype.setState=function(e){if(e==null||typeof e!="object"||typeof e.seed!="number"||typeof e.mz!="number"||typeof e.mw!="number")throw new Error("Invalid state.");this._seed=e.seed,this._mz=e.mz,this._mw=e.mw};N.random=N.prototype.random=function(){this._seed==null&&this.randomize();let e=this._mz,t=this._mw;return e=(e&65535)*36969+(e>>16)&4294967295,t=(t&65535)*18e3+(t>>16)&4294967295,this._mz=e,this._mw=t,.5+((e<<16)+t&4294967295)/4294967296};N.inRange=N.prototype.inRange=function(e,t){return e+this.random()*(t-e)};N.intInRange=N.prototype.intInRange=function(e,t){return e+Math.floor(this.random()*(t-e+1))};N.choice=N.prototype.choice=function(e){if(e.length===0)throw new Error("Cannot choose random element from empty array.");const t=this.intInRange(0,e.length-1);return e[t]};N.choices=N.prototype.choices=function(e,t){const i=new Array(t);for(let a=0;a<t;a++)i[a]=this.choice(e);return i};N.sample=N.prototype.sample=function(e,t){if(t>e.length)throw new Error("Sample size cannot exceed population size.");if(t===e.length)return this.shuffle([...e]);const i=e.length-1,a=new Array(t),r={};for(let s=0,l;s<t;s++){do l=this.intInRange(0,i);while(r[l]);a[s]=e[l],r[l]=!0}return a};N.shuffle=N.prototype.shuffle=function(e){for(let t=e.length-1;t>0;t--){const i=this.intInRange(0,t-1),a=e[t];e[t]=e[i],e[i]=a}return e};N.weightedChoice=N.prototype.weightedChoice=function(e,t){if(e.length===0)throw new Error("Cannot choose random element from empty array.");if(e.length!==t.length)throw new Error("Items and weights must have the same length.");let i=0;for(let s=0;s<t.length;s++){if(t[s]<0)throw new Error("Weights must be non-negative.");i+=t[s]}if(i===0)throw new Error("At least one weight must be greater than zero.");const a=this.random()*i;let r=0;for(let s=0;s<e.length;s++)if(r+=t[s],a<r)return e[s];return e[e.length-1]};N.gaussian=N.prototype.gaussian=function(e=0,t=1){const i=this.random(),a=this.random();return Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*a)*t+e};N.exponential=N.prototype.exponential=function(e){if(e<=0)throw new Error("For exponential distributions, lambda must be positive.");return-Math.log(1-this.random())/e};N.poisson=N.prototype.poisson=function(e){if(e<=0)throw new Error("For Poisson distributions, lambda must be positive.");const t=Math.exp(-e);let i=0,a=1;do i++,a*=this.random();while(a>t);return i-1};N._oldSrand=void 0;N.noConflict=function(){return N};var Tn=Yi('<line y1="0" y2="100%" class="grid-line svelte-12hhbkq"></line><line x1="0" x2="100%" class="grid-line svelte-12hhbkq"></line>',1),En=Yi('<path stroke-width="2" fill="none" class="curve-path svelte-12hhbkq"></path>'),kn=Yi('<circle r="12" fill="transparent" class="touch-target svelte-12hhbkq"></circle><circle r="4" stroke="#000" stroke-width="1" class="visual-point svelte-12hhbkq"></circle>',1),Pn=De('<div class="curve-container svelte-12hhbkq"><svg width="100%" height="100%" role="application" class="svelte-12hhbkq"><!><!><!></svg></div>');function xa(e,t){St(t,!0);let i=ve(t,"value",15),a=ve(t,"points",15),r=ve(t,"resolution",3,100),s=ve(t,"color",3,"#3b82f6"),l=ve(t,"height",3,200),o=ve(t,"onchange",3,()=>{}),f=ve(t,"defaultPoints",19,()=>[{x:0,y:1},{x:1,y:0}]);!a()||a().length===0?a(f().map((z,m)=>({x:z.x,y:z.y,id:m}))):a().some(m=>m.id===void 0)&&a(a().map((m,S)=>({x:m.x,y:m.y,id:m.id!==void 0?m.id:Date.now()+S})));let d=se(null),c=se(null),C=se(null);Lt(()=>{const z=[...a()].sort((S,E)=>S.x-E.x),m=new Float32Array(r());for(let S=0;S<r();S++){const E=S/(r()-1);m[S]=_(E,z)}i(m)});function _(z,m){let S=0;for(;S<m.length&&m[S].x<=z;)S++;if(S===0)return m[0].y;if(S===m.length)return m[m.length-1].y;const E=m[S-1],U=m[S],J=S-2>=0?m[S-2]:E,Q=S+1<m.length?m[S+1]:U,_e=U.x-E.x;if(_e<=1e-6)return E.y;let Fe;E===J?Fe=(U.y-E.y)/(U.x-E.x):Fe=(U.y-J.y)/(U.x-J.x);let Le;U===Q?Le=(U.y-E.y)/(U.x-E.x):Le=(Q.y-E.y)/(Q.x-E.x);const Pe=(z-E.x)/_e,Je=Fe*_e,kt=Le*_e,Be=Pe*Pe,g=Be*Pe,v=2*g-3*Be+1,H=g-2*Be+Pe,I=-2*g+3*Be,P=g-Be;return v*E.y+H*Je+I*U.y+P*kt}function y(z,m,S){if(z.length<2)return"";const E=[...z].sort((Q,_e)=>Q.x-_e.x);let U=`M ${E[0].x*m} ${(1-E[0].y)*S}`;const J=200;for(let Q=1;Q<=J;Q++){const _e=Q/J,Fe=_e*m,Pe=(1-Math.max(0,Math.min(1,_(_e,E))))*S;U+=` L ${Fe} ${Pe}`}return U}function k(z){if(!u(C))return{x:0,y:0};const m=u(C).getBoundingClientRect();return{x:Math.max(0,Math.min(1,(z.clientX-m.left)/m.width)),y:Math.max(0,Math.min(1,1-(z.clientY-m.top)/m.height))}}function p(z,m){z.stopPropagation(),z.target?.setPointerCapture(z.pointerId),V(d,m,!0)}function h(z){z.preventDefault();const m=k(z),S=Date.now(),E={x:m.x,y:m.y,id:S},U=a().findIndex(Q=>Q.x>m.x);if(U===-1)return;const J=[...a()];J.splice(U,0,E),a(J),V(d,S,!0),z.target.setPointerCapture(z.pointerId)}function M(z){if(u(d)===null)return;const m=k(z);a(a().map(S=>{if(S.id!==u(d))return S;let E=m.x;const U=a().findIndex(J=>J.id===u(d));if(U===0)E=0;else if(U===a().length-1)E=1;else{const J=a()[U-1],Q=a()[U+1];J&&(E=Math.max(J.x+.001,E)),Q&&(E=Math.min(Q.x-.001,E))}return{...S,x:E,y:m.y}}))}async function G(z){const m=u(d)!==null;V(d,null),z.target?.releasePointerCapture(z.pointerId),m&&(await Oi(),o()())}async function Y(z,m){z.stopPropagation();const S=a().findIndex(E=>E.id===m);S===0||S===a().length-1||(a(a().filter(E=>E.id!==m)),await Oi(),o()())}const F=[0,.25,.5,.75,1];var K=Pn();let re;var R=B(K);R.__pointermove=M,R.__pointerup=G,R.__pointerdown=h;var oe=B(R);Di(oe,17,()=>F,Ri,(z,m)=>{var S=Tn(),E=ut(S),U=w(E);ze(()=>{x(E,"x1",`${u(m)*100}%`),x(E,"x2",`${u(m)*100}%`),x(U,"y1",`${u(m)*100}%`),x(U,"y2",`${u(m)*100}%`)}),ce(z,S)});var ie=w(oe);{var Ie=z=>{var m=En();ze(S=>{x(m,"d",S),x(m,"stroke",s())},[()=>y(a(),u(C).clientWidth,u(C).clientHeight)]),ce(z,m)};Xi(ie,z=>{u(C)&&z(Ie)})}var be=w(ie);Di(be,17,a,Ri,(z,m)=>{var S=kn(),E=ut(S);E.__pointerdown=Q=>p(Q,u(m).id),E.__dblclick=Q=>Y(Q,u(m).id);let U;var J=w(E);Bt(J,"",{},{"pointer-events":"none"}),ze(()=>{x(E,"cx",`${u(m).x*100}%`),x(E,"cy",`${(1-u(m).y)*100}%`),U=Bt(E,"",U,{cursor:u(d)===u(m).id?"grabbing":"grab"}),x(J,"cx",`${u(m).x*100}%`),x(J,"cy",`${(1-u(m).y)*100}%`),x(J,"fill",u(d)===u(m).id||u(c)===u(m).id?"#fff":s())}),Pi("pointerenter",E,()=>V(c,u(m).id,!0)),Pi("pointerleave",E,()=>V(c,null)),ce(z,S)}),L(R),ki(R,z=>V(C,z),()=>u(C)),L(K),ze(()=>re=Bt(K,"",re,{height:`${l()??""}px`})),ce(e,K),Tt()}Gi(["pointermove","pointerup","pointerdown","dblclick"]);const Mn=e=>e;function An(e){const t=e-1;return t*t*t+1}function zn(e,{delay:t=0,duration:i=400,easing:a=Mn}={}){const r=+getComputedStyle(e).opacity;return{delay:t,duration:i,easing:a,css:s=>`opacity: ${s*r}`}}function On(e,{delay:t=0,duration:i=400,easing:a=An,axis:r="y"}={}){const s=getComputedStyle(e),l=+s.opacity,o=r==="y"?"height":"width",f=parseFloat(s[o]),d=r==="y"?["top","bottom"]:["left","right"],c=d.map(M=>`${M[0].toUpperCase()}${M.slice(1)}`),C=parseFloat(s[`padding${c[0]}`]),_=parseFloat(s[`padding${c[1]}`]),y=parseFloat(s[`margin${c[0]}`]),k=parseFloat(s[`margin${c[1]}`]),p=parseFloat(s[`border${c[0]}Width`]),h=parseFloat(s[`border${c[1]}Width`]);return{delay:t,duration:i,easing:a,css:M=>`overflow: hidden;opacity: ${Math.min(M*20,1)*l};${o}: ${M*f}px;padding-${d[0]}: ${M*C}px;padding-${d[1]}: ${M*_}px;margin-${d[0]}: ${M*y}px;margin-${d[1]}: ${M*k}px;border-${d[0]}-width: ${M*p}px;border-${d[1]}-width: ${M*h}px;min-${o}: 0`}}var In=De('<button class="fixed top-0 left-0 w-full h-full bg-black/69" title="Close Modal"></button> <div class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-5 bg-neutral-900 rounded-lg shadow-xl"><div class="pb-1 border-b-2 border-b-neutral-800 flex flex-row mb-2"><h3 class="text-lg font-bold grow"> </h3> <button class="text-neutral-200 text-sm p-1 hover:rotate-180 transition-transform" title="Close">&#10005;</button></div> <!></div>',1);function Sa(e,t){St(t,!0);let i=ve(t,"open",15,!1),a=ve(t,"title",3,"Info");var r=lr(),s=ut(r);{var l=o=>{var f=In(),d=ut(f);d.__click=()=>{i(!1)};var c=w(d,2),C=B(c),_=B(C),y=B(_,!0);L(_);var k=w(_,2);k.__click=()=>{i(!1)},L(C);var p=w(C,2);Ua(p,()=>t.children??Ge),L(c),ze(()=>Wa(y,a())),wa(3,d,()=>zn),wa(3,c,()=>On,()=>({axis:"y"})),ce(o,f)};Xi(s,o=>{i()&&o(l)})}ce(e,r),Tt()}Gi(["click"]);var Ji=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},n=(e,t,i)=>(Ji(e,t,"read from private field"),i?i.call(e):t.get(e)),D=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},ue=(e,t,i,a)=>(Ji(e,t,"write to private field"),t.set(e,i),i),Rn=(e,t,i,a)=>({set _(r){ue(e,t,r)},get _(){return n(e,t,a)}}),W=(e,t,i)=>(Ji(e,t,"access private method"),i),j=new Uint8Array(8),ke=new DataView(j.buffer),ne=e=>[(e%256+256)%256],$=e=>(ke.setUint16(0,e,!1),[j[0],j[1]]),Dn=e=>(ke.setInt16(0,e,!1),[j[0],j[1]]),$a=e=>(ke.setUint32(0,e,!1),[j[1],j[2],j[3]]),b=e=>(ke.setUint32(0,e,!1),[j[0],j[1],j[2],j[3]]),Fn=e=>(ke.setInt32(0,e,!1),[j[0],j[1],j[2],j[3]]),Ke=e=>(ke.setUint32(0,Math.floor(e/2**32),!1),ke.setUint32(4,e,!1),[j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7]]),Zi=e=>(ke.setInt16(0,2**8*e,!1),[j[0],j[1]]),Te=e=>(ke.setInt32(0,2**16*e,!1),[j[0],j[1],j[2],j[3]]),Ti=e=>(ke.setInt32(0,2**30*e,!1),[j[0],j[1],j[2],j[3]]),ye=(e,t=!1)=>{let i=Array(e.length).fill(null).map((a,r)=>e.charCodeAt(r));return t&&i.push(0),i},$t=e=>e&&e[e.length-1],Qi=e=>{let t;for(let i of e)(!t||i.presentationTimestamp>t.presentationTimestamp)&&(t=i);return t},Ee=(e,t,i=!0)=>{let a=e*t;return i?Math.round(a):a},Ha=e=>{let t=e*(Math.PI/180),i=Math.cos(t),a=Math.sin(t);return[i,a,0,-a,i,0,0,0,1]},qa=Ha(0),Xa=e=>[Te(e[0]),Te(e[1]),Ti(e[2]),Te(e[3]),Te(e[4]),Ti(e[5]),Te(e[6]),Te(e[7]),Ti(e[8])],gt=e=>!e||typeof e!="object"?e:Array.isArray(e)?e.map(gt):Object.fromEntries(Object.entries(e).map(([t,i])=>[t,gt(i)])),ft=e=>e>=0&&e<2**32,ae=(e,t,i)=>({type:e,contents:t&&new Uint8Array(t.flat(10)),children:i}),X=(e,t,i,a,r)=>ae(e,[ne(t),$a(i),a??[]],r),Ln=e=>{let t=512;return e.fragmented?ae("ftyp",[ye("iso5"),b(t),ye("iso5"),ye("iso6"),ye("mp41")]):ae("ftyp",[ye("isom"),b(t),ye("isom"),e.holdsAvc?ye("avc1"):[],ye("mp41")])},Bi=e=>({type:"mdat",largeSize:e}),Bn=e=>({type:"free",size:e}),Wt=(e,t,i=!1)=>ae("moov",null,[Wn(t,e),...e.map(a=>Un(a,t)),i?gs(e):null]),Wn=(e,t)=>{let i=Ee(Math.max(0,...t.filter(l=>l.samples.length>0).map(l=>{const o=Qi(l.samples);return o.presentationTimestamp+o.duration})),Ni),a=Math.max(...t.map(l=>l.id))+1,r=!ft(e)||!ft(i),s=r?Ke:b;return X("mvhd",+r,0,[s(e),s(e),b(Ni),s(i),Te(1),Zi(1),Array(10).fill(0),Xa(qa),Array(24).fill(0),b(a)])},Un=(e,t)=>ae("trak",null,[Nn(e,t),jn(e,t)]),Nn=(e,t)=>{let i=Qi(e.samples),a=Ee(i?i.presentationTimestamp+i.duration:0,Ni),r=!ft(t)||!ft(a),s=r?Ke:b,l;return e.info.type==="video"?l=typeof e.info.rotation=="number"?Ha(e.info.rotation):e.info.rotation:l=qa,X("tkhd",+r,3,[s(t),s(t),b(e.id),b(0),s(a),Array(8).fill(0),$(0),$(0),Zi(e.info.type==="audio"?1:0),$(0),Xa(l),Te(e.info.type==="video"?e.info.width:0),Te(e.info.type==="video"?e.info.height:0)])},jn=(e,t)=>ae("mdia",null,[Vn(e,t),$n(e.info.type==="video"?"vide":"soun"),Hn(e)]),Vn=(e,t)=>{let i=Qi(e.samples),a=Ee(i?i.presentationTimestamp+i.duration:0,e.timescale),r=!ft(t)||!ft(a),s=r?Ke:b;return X("mdhd",+r,0,[s(t),s(t),b(e.timescale),s(a),$(21956),$(0)])},$n=e=>X("hdlr",0,0,[ye("mhlr"),ye(e),b(0),b(0),b(0),ye("mp4-muxer-hdlr",!0)]),Hn=e=>ae("minf",null,[e.info.type==="video"?qn():Xn(),Gn(),Jn(e)]),qn=()=>X("vmhd",0,1,[$(0),$(0),$(0),$(0)]),Xn=()=>X("smhd",0,0,[$(0),$(0)]),Gn=()=>ae("dinf",null,[Yn()]),Yn=()=>X("dref",0,0,[b(1)],[Kn()]),Kn=()=>X("url ",0,1),Jn=e=>{const t=e.compositionTimeOffsetTable.length>1||e.compositionTimeOffsetTable.some(i=>i.sampleCompositionTimeOffset!==0);return ae("stbl",null,[Zn(e),ds(e),cs(e),hs(e),ps(e),ms(e),t?vs(e):null])},Zn=e=>X("stsd",0,0,[b(1)],[e.info.type==="video"?Qn(ks[e.info.codec],e):ls(Ms[e.info.codec],e)]),Qn=(e,t)=>ae(e,[Array(6).fill(0),$(1),$(0),$(0),Array(12).fill(0),$(t.info.width),$(t.info.height),b(4718592),b(4718592),b(0),$(1),Array(32).fill(0),$(24),Dn(65535)],[Ps[t.info.codec](t),t.info.decoderConfig.colorSpace?as(t):null]),es={bt709:1,bt470bg:5,smpte170m:6},ts={bt709:1,smpte170m:6,"iec61966-2-1":13},is={rgb:0,bt709:1,bt470bg:5,smpte170m:6},as=e=>ae("colr",[ye("nclx"),$(es[e.info.decoderConfig.colorSpace.primaries]),$(ts[e.info.decoderConfig.colorSpace.transfer]),$(is[e.info.decoderConfig.colorSpace.matrix]),ne((e.info.decoderConfig.colorSpace.fullRange?1:0)<<7)]),rs=e=>e.info.decoderConfig&&ae("avcC",[...new Uint8Array(e.info.decoderConfig.description)]),ns=e=>e.info.decoderConfig&&ae("hvcC",[...new Uint8Array(e.info.decoderConfig.description)]),ss=e=>{if(!e.info.decoderConfig)return null;let t=e.info.decoderConfig;if(!t.colorSpace)throw new Error("'colorSpace' is required in the decoder config for VP9.");let i=t.codec.split("."),a=Number(i[1]),r=Number(i[2]),o=(Number(i[3])<<4)+(0<<1)+Number(t.colorSpace.fullRange);return X("vpcC",1,0,[ne(a),ne(r),ne(o),ne(2),ne(2),ne(2),$(0)])},os=()=>{let i=(1<<7)+1;return ae("av1C",[i,0,0,0])},ls=(e,t)=>ae(e,[Array(6).fill(0),$(1),$(0),$(0),b(0),$(t.info.numberOfChannels),$(16),$(0),$(0),Te(t.info.sampleRate)],[As[t.info.codec](t)]),us=e=>{let t=new Uint8Array(e.info.decoderConfig.description);return X("esds",0,0,[b(58753152),ne(32+t.byteLength),$(1),ne(0),b(75530368),ne(18+t.byteLength),ne(64),ne(21),$a(0),b(130071),b(130071),b(92307584),ne(t.byteLength),...t,b(109084800),ne(1),ne(2)])},fs=e=>{let t=3840,i=0;const a=e.info.decoderConfig?.description;if(a){if(a.byteLength<18)throw new TypeError("Invalid decoder description provided for Opus; must be at least 18 bytes long.");const r=ArrayBuffer.isView(a)?new DataView(a.buffer,a.byteOffset,a.byteLength):new DataView(a);t=r.getUint16(10,!0),i=r.getInt16(14,!0)}return ae("dOps",[ne(0),ne(e.info.numberOfChannels),$(t),b(e.info.sampleRate),Zi(i),ne(0)])},ds=e=>X("stts",0,0,[b(e.timeToSampleTable.length),e.timeToSampleTable.map(t=>[b(t.sampleCount),b(t.sampleDelta)])]),cs=e=>{if(e.samples.every(i=>i.type==="key"))return null;let t=[...e.samples.entries()].filter(([,i])=>i.type==="key");return X("stss",0,0,[b(t.length),t.map(([i])=>b(i+1))])},hs=e=>X("stsc",0,0,[b(e.compactlyCodedChunkTable.length),e.compactlyCodedChunkTable.map(t=>[b(t.firstChunk),b(t.samplesPerChunk),b(1)])]),ps=e=>X("stsz",0,0,[b(0),b(e.samples.length),e.samples.map(t=>b(t.size))]),ms=e=>e.finalizedChunks.length>0&&$t(e.finalizedChunks).offset>=2**32?X("co64",0,0,[b(e.finalizedChunks.length),e.finalizedChunks.map(t=>Ke(t.offset))]):X("stco",0,0,[b(e.finalizedChunks.length),e.finalizedChunks.map(t=>b(t.offset))]),vs=e=>X("ctts",0,0,[b(e.compositionTimeOffsetTable.length),e.compositionTimeOffsetTable.map(t=>[b(t.sampleCount),b(t.sampleCompositionTimeOffset)])]),gs=e=>ae("mvex",null,e.map(ws)),ws=e=>X("trex",0,0,[b(e.id),b(1),b(0),b(0),b(0)]),Ta=(e,t)=>ae("moof",null,[ys(e),...t.map(bs)]),ys=e=>X("mfhd",0,0,[b(e)]),Ga=e=>{let t=0,i=0,a=0,r=0,s=e.type==="delta";return i|=+s,s?t|=1:t|=2,t<<24|i<<16|a<<8|r},bs=e=>ae("traf",null,[_s(e),Cs(e),xs(e)]),_s=e=>{let t=0;t|=8,t|=16,t|=32,t|=131072;let i=e.currentChunk.samples[1]??e.currentChunk.samples[0],a={duration:i.timescaleUnitsToNextSample,size:i.size,flags:Ga(i)};return X("tfhd",0,t,[b(e.id),b(a.duration),b(a.size),b(a.flags)])},Cs=e=>X("tfdt",1,0,[Ke(Ee(e.currentChunk.startTimestamp,e.timescale))]),xs=e=>{let t=e.currentChunk.samples.map(p=>p.timescaleUnitsToNextSample),i=e.currentChunk.samples.map(p=>p.size),a=e.currentChunk.samples.map(Ga),r=e.currentChunk.samples.map(p=>Ee(p.presentationTimestamp-p.decodeTimestamp,e.timescale)),s=new Set(t),l=new Set(i),o=new Set(a),f=new Set(r),d=o.size===2&&a[0]!==a[1],c=s.size>1,C=l.size>1,_=!d&&o.size>1,y=f.size>1||[...f].some(p=>p!==0),k=0;return k|=1,k|=4*+d,k|=256*+c,k|=512*+C,k|=1024*+_,k|=2048*+y,X("trun",1,k,[b(e.currentChunk.samples.length),b(e.currentChunk.offset-e.currentChunk.moofOffset||0),d?b(a[0]):[],e.currentChunk.samples.map((p,h)=>[c?b(t[h]):[],C?b(i[h]):[],_?b(a[h]):[],y?Fn(r[h]):[]])])},Ss=e=>ae("mfra",null,[...e.map(Ts),Es()]),Ts=(e,t)=>X("tfra",1,0,[b(e.id),b(63),b(e.finalizedChunks.length),e.finalizedChunks.map(a=>[Ke(Ee(a.startTimestamp,e.timescale)),Ke(a.moofOffset),b(t+1),b(1),b(1)])]),Es=()=>X("mfro",0,0,[b(0)]),ks={avc:"avc1",hevc:"hvc1",vp9:"vp09",av1:"av01"},Ps={avc:rs,hevc:ns,vp9:ss,av1:os},Ms={aac:"mp4a",opus:"Opus"},As={aac:us,opus:fs},Kt=class{},Ya=class extends Kt{constructor(){super(...arguments),this.buffer=null}},Ka=class extends Kt{constructor(e){if(super(),this.options=e,typeof e!="object")throw new TypeError("StreamTarget requires an options object to be passed to its constructor.");if(e.onData){if(typeof e.onData!="function")throw new TypeError("options.onData, when provided, must be a function.");if(e.onData.length<2)throw new TypeError("options.onData, when provided, must be a function that takes in at least two arguments (data and position). Ignoring the position argument, which specifies the byte offset at which the data is to be written, can lead to broken outputs.")}if(e.chunked!==void 0&&typeof e.chunked!="boolean")throw new TypeError("options.chunked, when provided, must be a boolean.");if(e.chunkSize!==void 0&&(!Number.isInteger(e.chunkSize)||e.chunkSize<1024))throw new TypeError("options.chunkSize, when provided, must be an integer and not smaller than 1024.")}},zs=class extends Kt{constructor(e,t){if(super(),this.stream=e,this.options=t,!(e instanceof FileSystemWritableFileStream))throw new TypeError("FileSystemWritableFileStreamTarget requires a FileSystemWritableFileStream instance.");if(t!==void 0&&typeof t!="object")throw new TypeError("FileSystemWritableFileStreamTarget's options, when provided, must be an object.");if(t&&t.chunkSize!==void 0&&(!Number.isInteger(t.chunkSize)||t.chunkSize<=0))throw new TypeError("options.chunkSize, when provided, must be a positive integer")}},$e,nt,Ja=class{constructor(){this.pos=0,D(this,$e,new Uint8Array(8)),D(this,nt,new DataView(n(this,$e).buffer)),this.offsets=new WeakMap}seek(e){this.pos=e}writeU32(e){n(this,nt).setUint32(0,e,!1),this.write(n(this,$e).subarray(0,4))}writeU64(e){n(this,nt).setUint32(0,Math.floor(e/2**32),!1),n(this,nt).setUint32(4,e,!1),this.write(n(this,$e).subarray(0,8))}writeAscii(e){for(let t=0;t<e.length;t++)n(this,nt).setUint8(t%8,e.charCodeAt(t)),t%8===7&&this.write(n(this,$e));e.length%8!==0&&this.write(n(this,$e).subarray(0,e.length%8))}writeBox(e){if(this.offsets.set(e,this.pos),e.contents&&!e.children)this.writeBoxHeader(e,e.size??e.contents.byteLength+8),this.write(e.contents);else{let t=this.pos;if(this.writeBoxHeader(e,0),e.contents&&this.write(e.contents),e.children)for(let r of e.children)r&&this.writeBox(r);let i=this.pos,a=e.size??i-t;this.seek(t),this.writeBoxHeader(e,a),this.seek(i)}}writeBoxHeader(e,t){this.writeU32(e.largeSize?1:t),this.writeAscii(e.type),e.largeSize&&this.writeU64(t)}measureBoxHeader(e){return 8+(e.largeSize?8:0)}patchBox(e){let t=this.pos;this.seek(this.offsets.get(e)),this.writeBox(e),this.seek(t)}measureBox(e){if(e.contents&&!e.children)return this.measureBoxHeader(e)+e.contents.byteLength;{let t=this.measureBoxHeader(e);if(e.contents&&(t+=e.contents.byteLength),e.children)for(let i of e.children)i&&(t+=this.measureBox(i));return t}}};$e=new WeakMap;nt=new WeakMap;var Ut,Ye,Ct,pt,Nt,Wi,Os=class extends Ja{constructor(e){super(),D(this,Nt),D(this,Ut,void 0),D(this,Ye,new ArrayBuffer(2**16)),D(this,Ct,new Uint8Array(n(this,Ye))),D(this,pt,0),ue(this,Ut,e)}write(e){W(this,Nt,Wi).call(this,this.pos+e.byteLength),n(this,Ct).set(e,this.pos),this.pos+=e.byteLength,ue(this,pt,Math.max(n(this,pt),this.pos))}finalize(){W(this,Nt,Wi).call(this,this.pos),n(this,Ut).buffer=n(this,Ye).slice(0,Math.max(n(this,pt),this.pos))}};Ut=new WeakMap;Ye=new WeakMap;Ct=new WeakMap;pt=new WeakMap;Nt=new WeakSet;Wi=function(e){let t=n(this,Ye).byteLength;for(;t<e;)t*=2;if(t===n(this,Ye).byteLength)return;let i=new ArrayBuffer(t),a=new Uint8Array(i);a.set(n(this,Ct),0),ue(this,Ye,i),ue(this,Ct,a)};var Is=2**24,Rs=2,wt,He,mt,Oe,ge,Ht,Ui,ea,Za,ta,Qa,yt,qt,ia=class extends Ja{constructor(e){super(),D(this,Ht),D(this,ea),D(this,ta),D(this,yt),D(this,wt,void 0),D(this,He,[]),D(this,mt,void 0),D(this,Oe,void 0),D(this,ge,[]),ue(this,wt,e),ue(this,mt,e.options?.chunked??!1),ue(this,Oe,e.options?.chunkSize??Is)}write(e){n(this,He).push({data:e.slice(),start:this.pos}),this.pos+=e.byteLength}flush(){if(n(this,He).length===0)return;let e=[],t=[...n(this,He)].sort((i,a)=>i.start-a.start);e.push({start:t[0].start,size:t[0].data.byteLength});for(let i=1;i<t.length;i++){let a=e[e.length-1],r=t[i];r.start<=a.start+a.size?a.size=Math.max(a.size,r.start+r.data.byteLength-a.start):e.push({start:r.start,size:r.data.byteLength})}for(let i of e){i.data=new Uint8Array(i.size);for(let a of n(this,He))i.start<=a.start&&a.start<i.start+i.size&&i.data.set(a.data,a.start-i.start);n(this,mt)?(W(this,Ht,Ui).call(this,i.data,i.start),W(this,yt,qt).call(this)):n(this,wt).options.onData?.(i.data,i.start)}n(this,He).length=0}finalize(){n(this,mt)&&W(this,yt,qt).call(this,!0)}};wt=new WeakMap;He=new WeakMap;mt=new WeakMap;Oe=new WeakMap;ge=new WeakMap;Ht=new WeakSet;Ui=function(e,t){let i=n(this,ge).findIndex(o=>o.start<=t&&t<o.start+n(this,Oe));i===-1&&(i=W(this,ta,Qa).call(this,t));let a=n(this,ge)[i],r=t-a.start,s=e.subarray(0,Math.min(n(this,Oe)-r,e.byteLength));a.data.set(s,r);let l={start:r,end:r+s.byteLength};if(W(this,ea,Za).call(this,a,l),a.written[0].start===0&&a.written[0].end===n(this,Oe)&&(a.shouldFlush=!0),n(this,ge).length>Rs){for(let o=0;o<n(this,ge).length-1;o++)n(this,ge)[o].shouldFlush=!0;W(this,yt,qt).call(this)}s.byteLength<e.byteLength&&W(this,Ht,Ui).call(this,e.subarray(s.byteLength),t+s.byteLength)};ea=new WeakSet;Za=function(e,t){let i=0,a=e.written.length-1,r=-1;for(;i<=a;){let s=Math.floor(i+(a-i+1)/2);e.written[s].start<=t.start?(i=s+1,r=s):a=s-1}for(e.written.splice(r+1,0,t),(r===-1||e.written[r].end<t.start)&&r++;r<e.written.length-1&&e.written[r].end>=e.written[r+1].start;)e.written[r].end=Math.max(e.written[r].end,e.written[r+1].end),e.written.splice(r+1,1)};ta=new WeakSet;Qa=function(e){let i={start:Math.floor(e/n(this,Oe))*n(this,Oe),data:new Uint8Array(n(this,Oe)),written:[],shouldFlush:!1};return n(this,ge).push(i),n(this,ge).sort((a,r)=>a.start-r.start),n(this,ge).indexOf(i)};yt=new WeakSet;qt=function(e=!1){for(let t=0;t<n(this,ge).length;t++){let i=n(this,ge)[t];if(!(!i.shouldFlush&&!e)){for(let a of i.written)n(this,wt).options.onData?.(i.data.subarray(a.start,a.end),i.start+a.start);n(this,ge).splice(t--,1)}}};var Ds=class extends ia{constructor(e){super(new Ka({onData:(t,i)=>e.stream.write({type:"write",data:t,position:i}),chunked:!0,chunkSize:e.options?.chunkSize}))}},Ni=1e3,Fs=["avc","hevc","vp9","av1"],Ls=["aac","opus"],Bs=2082844800,Ws=["strict","offset","cross-track-offset"],T,A,Xt,me,fe,le,ot,lt,aa,qe,Xe,bt,ji,er,Vi,tr,ra,ir,$i,ar,na,rr,jt,Hi,xe,Me,sa,nr,_t,Gt,Yt,oa,dt,Et,Vt,qi,Us=class{constructor(e){if(D(this,ji),D(this,Vi),D(this,ra),D(this,$i),D(this,na),D(this,jt),D(this,xe),D(this,sa),D(this,_t),D(this,Yt),D(this,dt),D(this,Vt),D(this,T,void 0),D(this,A,void 0),D(this,Xt,void 0),D(this,me,void 0),D(this,fe,null),D(this,le,null),D(this,ot,Math.floor(Date.now()/1e3)+Bs),D(this,lt,[]),D(this,aa,1),D(this,qe,[]),D(this,Xe,[]),D(this,bt,!1),W(this,ji,er).call(this,e),e.video=gt(e.video),e.audio=gt(e.audio),e.fastStart=gt(e.fastStart),this.target=e.target,ue(this,T,{firstTimestampBehavior:"strict",...e}),e.target instanceof Ya)ue(this,A,new Os(e.target));else if(e.target instanceof Ka)ue(this,A,new ia(e.target));else if(e.target instanceof zs)ue(this,A,new Ds(e.target));else throw new Error(`Invalid target: ${e.target}`);W(this,$i,ar).call(this),W(this,Vi,tr).call(this)}addVideoChunk(e,t,i,a){if(!(e instanceof EncodedVideoChunk))throw new TypeError("addVideoChunk's first argument (sample) must be of type EncodedVideoChunk.");if(t&&typeof t!="object")throw new TypeError("addVideoChunk's second argument (meta), when provided, must be an object.");if(i!==void 0&&(!Number.isFinite(i)||i<0))throw new TypeError("addVideoChunk's third argument (timestamp), when provided, must be a non-negative real number.");if(a!==void 0&&!Number.isFinite(a))throw new TypeError("addVideoChunk's fourth argument (compositionTimeOffset), when provided, must be a real number.");let r=new Uint8Array(e.byteLength);e.copyTo(r),this.addVideoChunkRaw(r,e.type,i??e.timestamp,e.duration,t,a)}addVideoChunkRaw(e,t,i,a,r,s){if(!(e instanceof Uint8Array))throw new TypeError("addVideoChunkRaw's first argument (data) must be an instance of Uint8Array.");if(t!=="key"&&t!=="delta")throw new TypeError("addVideoChunkRaw's second argument (type) must be either 'key' or 'delta'.");if(!Number.isFinite(i)||i<0)throw new TypeError("addVideoChunkRaw's third argument (timestamp) must be a non-negative real number.");if(!Number.isFinite(a)||a<0)throw new TypeError("addVideoChunkRaw's fourth argument (duration) must be a non-negative real number.");if(r&&typeof r!="object")throw new TypeError("addVideoChunkRaw's fifth argument (meta), when provided, must be an object.");if(s!==void 0&&!Number.isFinite(s))throw new TypeError("addVideoChunkRaw's sixth argument (compositionTimeOffset), when provided, must be a real number.");if(W(this,Vt,qi).call(this),!n(this,T).video)throw new Error("No video track declared.");if(typeof n(this,T).fastStart=="object"&&n(this,fe).samples.length===n(this,T).fastStart.expectedVideoChunks)throw new Error(`Cannot add more video chunks than specified in 'fastStart' (${n(this,T).fastStart.expectedVideoChunks}).`);let l=W(this,jt,Hi).call(this,n(this,fe),e,t,i,a,r,s);if(n(this,T).fastStart==="fragmented"&&n(this,le)){for(;n(this,Xe).length>0&&n(this,Xe)[0].decodeTimestamp<=l.decodeTimestamp;){let o=n(this,Xe).shift();W(this,xe,Me).call(this,n(this,le),o)}l.decodeTimestamp<=n(this,le).lastDecodeTimestamp?W(this,xe,Me).call(this,n(this,fe),l):n(this,qe).push(l)}else W(this,xe,Me).call(this,n(this,fe),l)}addAudioChunk(e,t,i){if(!(e instanceof EncodedAudioChunk))throw new TypeError("addAudioChunk's first argument (sample) must be of type EncodedAudioChunk.");if(t&&typeof t!="object")throw new TypeError("addAudioChunk's second argument (meta), when provided, must be an object.");if(i!==void 0&&(!Number.isFinite(i)||i<0))throw new TypeError("addAudioChunk's third argument (timestamp), when provided, must be a non-negative real number.");let a=new Uint8Array(e.byteLength);e.copyTo(a),this.addAudioChunkRaw(a,e.type,i??e.timestamp,e.duration,t)}addAudioChunkRaw(e,t,i,a,r){if(!(e instanceof Uint8Array))throw new TypeError("addAudioChunkRaw's first argument (data) must be an instance of Uint8Array.");if(t!=="key"&&t!=="delta")throw new TypeError("addAudioChunkRaw's second argument (type) must be either 'key' or 'delta'.");if(!Number.isFinite(i)||i<0)throw new TypeError("addAudioChunkRaw's third argument (timestamp) must be a non-negative real number.");if(!Number.isFinite(a)||a<0)throw new TypeError("addAudioChunkRaw's fourth argument (duration) must be a non-negative real number.");if(r&&typeof r!="object")throw new TypeError("addAudioChunkRaw's fifth argument (meta), when provided, must be an object.");if(W(this,Vt,qi).call(this),!n(this,T).audio)throw new Error("No audio track declared.");if(typeof n(this,T).fastStart=="object"&&n(this,le).samples.length===n(this,T).fastStart.expectedAudioChunks)throw new Error(`Cannot add more audio chunks than specified in 'fastStart' (${n(this,T).fastStart.expectedAudioChunks}).`);let s=W(this,jt,Hi).call(this,n(this,le),e,t,i,a,r);if(n(this,T).fastStart==="fragmented"&&n(this,fe)){for(;n(this,qe).length>0&&n(this,qe)[0].decodeTimestamp<=s.decodeTimestamp;){let l=n(this,qe).shift();W(this,xe,Me).call(this,n(this,fe),l)}s.decodeTimestamp<=n(this,fe).lastDecodeTimestamp?W(this,xe,Me).call(this,n(this,le),s):n(this,Xe).push(s)}else W(this,xe,Me).call(this,n(this,le),s)}finalize(){if(n(this,bt))throw new Error("Cannot finalize a muxer more than once.");if(n(this,T).fastStart==="fragmented"){for(let t of n(this,qe))W(this,xe,Me).call(this,n(this,fe),t);for(let t of n(this,Xe))W(this,xe,Me).call(this,n(this,le),t);W(this,Yt,oa).call(this,!1)}else n(this,fe)&&W(this,_t,Gt).call(this,n(this,fe)),n(this,le)&&W(this,_t,Gt).call(this,n(this,le));let e=[n(this,fe),n(this,le)].filter(Boolean);if(n(this,T).fastStart==="in-memory"){let t;for(let a=0;a<2;a++){let r=Wt(e,n(this,ot)),s=n(this,A).measureBox(r);t=n(this,A).measureBox(n(this,me));let l=n(this,A).pos+s+t;for(let o of n(this,lt)){o.offset=l;for(let{data:f}of o.samples)l+=f.byteLength,t+=f.byteLength}if(l<2**32)break;t>=2**32&&(n(this,me).largeSize=!0)}let i=Wt(e,n(this,ot));n(this,A).writeBox(i),n(this,me).size=t,n(this,A).writeBox(n(this,me));for(let a of n(this,lt))for(let r of a.samples)n(this,A).write(r.data),r.data=null}else if(n(this,T).fastStart==="fragmented"){let t=n(this,A).pos,i=Ss(e);n(this,A).writeBox(i);let a=n(this,A).pos-t;n(this,A).seek(n(this,A).pos-4),n(this,A).writeU32(a)}else{let t=n(this,A).offsets.get(n(this,me)),i=n(this,A).pos-t;n(this,me).size=i,n(this,me).largeSize=i>=2**32,n(this,A).patchBox(n(this,me));let a=Wt(e,n(this,ot));if(typeof n(this,T).fastStart=="object"){n(this,A).seek(n(this,Xt)),n(this,A).writeBox(a);let r=t-n(this,A).pos;n(this,A).writeBox(Bn(r))}else n(this,A).writeBox(a)}W(this,dt,Et).call(this),n(this,A).finalize(),ue(this,bt,!0)}};T=new WeakMap;A=new WeakMap;Xt=new WeakMap;me=new WeakMap;fe=new WeakMap;le=new WeakMap;ot=new WeakMap;lt=new WeakMap;aa=new WeakMap;qe=new WeakMap;Xe=new WeakMap;bt=new WeakMap;ji=new WeakSet;er=function(e){if(typeof e!="object")throw new TypeError("The muxer requires an options object to be passed to its constructor.");if(!(e.target instanceof Kt))throw new TypeError("The target must be provided and an instance of Target.");if(e.video){if(!Fs.includes(e.video.codec))throw new TypeError(`Unsupported video codec: ${e.video.codec}`);if(!Number.isInteger(e.video.width)||e.video.width<=0)throw new TypeError(`Invalid video width: ${e.video.width}. Must be a positive integer.`);if(!Number.isInteger(e.video.height)||e.video.height<=0)throw new TypeError(`Invalid video height: ${e.video.height}. Must be a positive integer.`);const t=e.video.rotation;if(typeof t=="number"&&![0,90,180,270].includes(t))throw new TypeError(`Invalid video rotation: ${t}. Has to be 0, 90, 180 or 270.`);if(Array.isArray(t)&&(t.length!==9||t.some(i=>typeof i!="number")))throw new TypeError(`Invalid video transformation matrix: ${t.join()}`);if(e.video.frameRate!==void 0&&(!Number.isInteger(e.video.frameRate)||e.video.frameRate<=0))throw new TypeError(`Invalid video frame rate: ${e.video.frameRate}. Must be a positive integer.`)}if(e.audio){if(!Ls.includes(e.audio.codec))throw new TypeError(`Unsupported audio codec: ${e.audio.codec}`);if(!Number.isInteger(e.audio.numberOfChannels)||e.audio.numberOfChannels<=0)throw new TypeError(`Invalid number of audio channels: ${e.audio.numberOfChannels}. Must be a positive integer.`);if(!Number.isInteger(e.audio.sampleRate)||e.audio.sampleRate<=0)throw new TypeError(`Invalid audio sample rate: ${e.audio.sampleRate}. Must be a positive integer.`)}if(e.firstTimestampBehavior&&!Ws.includes(e.firstTimestampBehavior))throw new TypeError(`Invalid first timestamp behavior: ${e.firstTimestampBehavior}`);if(typeof e.fastStart=="object"){if(e.video){if(e.fastStart.expectedVideoChunks===void 0)throw new TypeError("'fastStart' is an object but is missing property 'expectedVideoChunks'.");if(!Number.isInteger(e.fastStart.expectedVideoChunks)||e.fastStart.expectedVideoChunks<0)throw new TypeError("'expectedVideoChunks' must be a non-negative integer.")}if(e.audio){if(e.fastStart.expectedAudioChunks===void 0)throw new TypeError("'fastStart' is an object but is missing property 'expectedAudioChunks'.");if(!Number.isInteger(e.fastStart.expectedAudioChunks)||e.fastStart.expectedAudioChunks<0)throw new TypeError("'expectedAudioChunks' must be a non-negative integer.")}}else if(![!1,"in-memory","fragmented"].includes(e.fastStart))throw new TypeError("'fastStart' option must be false, 'in-memory', 'fragmented' or an object.");if(e.minFragmentDuration!==void 0&&(!Number.isFinite(e.minFragmentDuration)||e.minFragmentDuration<0))throw new TypeError("'minFragmentDuration' must be a non-negative number.")};Vi=new WeakSet;tr=function(){if(n(this,A).writeBox(Ln({holdsAvc:n(this,T).video?.codec==="avc",fragmented:n(this,T).fastStart==="fragmented"})),ue(this,Xt,n(this,A).pos),n(this,T).fastStart==="in-memory")ue(this,me,Bi(!1));else if(n(this,T).fastStart!=="fragmented"){if(typeof n(this,T).fastStart=="object"){let e=W(this,ra,ir).call(this);n(this,A).seek(n(this,A).pos+e)}ue(this,me,Bi(!0)),n(this,A).writeBox(n(this,me))}W(this,dt,Et).call(this)};ra=new WeakSet;ir=function(){if(typeof n(this,T).fastStart!="object")return;let e=0,t=[n(this,T).fastStart.expectedVideoChunks,n(this,T).fastStart.expectedAudioChunks];for(let i of t)i&&(e+=8*Math.ceil(2/3*i),e+=4*i,e+=12*Math.ceil(2/3*i),e+=4*i,e+=8*i);return e+=4096,e};$i=new WeakSet;ar=function(){if(n(this,T).video&&ue(this,fe,{id:1,info:{type:"video",codec:n(this,T).video.codec,width:n(this,T).video.width,height:n(this,T).video.height,rotation:n(this,T).video.rotation??0,decoderConfig:null},timescale:n(this,T).video.frameRate??57600,samples:[],finalizedChunks:[],currentChunk:null,firstDecodeTimestamp:void 0,lastDecodeTimestamp:-1,timeToSampleTable:[],compositionTimeOffsetTable:[],lastTimescaleUnits:null,lastSample:null,compactlyCodedChunkTable:[]}),n(this,T).audio&&(ue(this,le,{id:n(this,T).video?2:1,info:{type:"audio",codec:n(this,T).audio.codec,numberOfChannels:n(this,T).audio.numberOfChannels,sampleRate:n(this,T).audio.sampleRate,decoderConfig:null},timescale:n(this,T).audio.sampleRate,samples:[],finalizedChunks:[],currentChunk:null,firstDecodeTimestamp:void 0,lastDecodeTimestamp:-1,timeToSampleTable:[],compositionTimeOffsetTable:[],lastTimescaleUnits:null,lastSample:null,compactlyCodedChunkTable:[]}),n(this,T).audio.codec==="aac")){let e=W(this,na,rr).call(this,2,n(this,T).audio.sampleRate,n(this,T).audio.numberOfChannels);n(this,le).info.decoderConfig={codec:n(this,T).audio.codec,description:e,numberOfChannels:n(this,T).audio.numberOfChannels,sampleRate:n(this,T).audio.sampleRate}}};na=new WeakSet;rr=function(e,t,i){let r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350].indexOf(t),s=i,l="";l+=e.toString(2).padStart(5,"0"),l+=r.toString(2).padStart(4,"0"),r===15&&(l+=t.toString(2).padStart(24,"0")),l+=s.toString(2).padStart(4,"0");let o=Math.ceil(l.length/8)*8;l=l.padEnd(o,"0");let f=new Uint8Array(l.length/8);for(let d=0;d<l.length;d+=8)f[d/8]=parseInt(l.slice(d,d+8),2);return f};jt=new WeakSet;Hi=function(e,t,i,a,r,s,l){let o=a/1e6,f=(a-(l??0))/1e6,d=r/1e6,c=W(this,sa,nr).call(this,o,f,e);return o=c.presentationTimestamp,f=c.decodeTimestamp,s?.decoderConfig&&(e.info.decoderConfig===null?e.info.decoderConfig=s.decoderConfig:Object.assign(e.info.decoderConfig,s.decoderConfig)),{presentationTimestamp:o,decodeTimestamp:f,duration:d,data:t,size:t.byteLength,type:i,timescaleUnitsToNextSample:Ee(d,e.timescale)}};xe=new WeakSet;Me=function(e,t){n(this,T).fastStart!=="fragmented"&&e.samples.push(t);const i=Ee(t.presentationTimestamp-t.decodeTimestamp,e.timescale);if(e.lastTimescaleUnits!==null){let r=Ee(t.decodeTimestamp,e.timescale,!1),s=Math.round(r-e.lastTimescaleUnits);if(e.lastTimescaleUnits+=s,e.lastSample.timescaleUnitsToNextSample=s,n(this,T).fastStart!=="fragmented"){let l=$t(e.timeToSampleTable);l.sampleCount===1?(l.sampleDelta=s,l.sampleCount++):l.sampleDelta===s?l.sampleCount++:(l.sampleCount--,e.timeToSampleTable.push({sampleCount:2,sampleDelta:s}));const o=$t(e.compositionTimeOffsetTable);o.sampleCompositionTimeOffset===i?o.sampleCount++:e.compositionTimeOffsetTable.push({sampleCount:1,sampleCompositionTimeOffset:i})}}else e.lastTimescaleUnits=0,n(this,T).fastStart!=="fragmented"&&(e.timeToSampleTable.push({sampleCount:1,sampleDelta:Ee(t.duration,e.timescale)}),e.compositionTimeOffsetTable.push({sampleCount:1,sampleCompositionTimeOffset:i}));e.lastSample=t;let a=!1;if(!e.currentChunk)a=!0;else{let r=t.presentationTimestamp-e.currentChunk.startTimestamp;if(n(this,T).fastStart==="fragmented"){let s=n(this,fe)??n(this,le);const l=n(this,T).minFragmentDuration??1;e===s&&t.type==="key"&&r>=l&&(a=!0,W(this,Yt,oa).call(this))}else a=r>=.5}a&&(e.currentChunk&&W(this,_t,Gt).call(this,e),e.currentChunk={startTimestamp:t.presentationTimestamp,samples:[]}),e.currentChunk.samples.push(t)};sa=new WeakSet;nr=function(e,t,i){const a=n(this,T).firstTimestampBehavior==="strict",r=i.lastDecodeTimestamp===-1;if(a&&r&&t!==0)throw new Error(`The first chunk for your media track must have a timestamp of 0 (received DTS=${t}).Non-zero first timestamps are often caused by directly piping frames or audio data from a MediaStreamTrack into the encoder. Their timestamps are typically relative to the age of thedocument, which is probably what you want.

If you want to offset all timestamps of a track such that the first one is zero, set firstTimestampBehavior: 'offset' in the options.
`);if(n(this,T).firstTimestampBehavior==="offset"||n(this,T).firstTimestampBehavior==="cross-track-offset"){i.firstDecodeTimestamp===void 0&&(i.firstDecodeTimestamp=t);let l;n(this,T).firstTimestampBehavior==="offset"?l=i.firstDecodeTimestamp:l=Math.min(n(this,fe)?.firstDecodeTimestamp??1/0,n(this,le)?.firstDecodeTimestamp??1/0),t-=l,e-=l}if(t<i.lastDecodeTimestamp)throw new Error(`Timestamps must be monotonically increasing (DTS went from ${i.lastDecodeTimestamp*1e6} to ${t*1e6}).`);return i.lastDecodeTimestamp=t,{presentationTimestamp:e,decodeTimestamp:t}};_t=new WeakSet;Gt=function(e){if(n(this,T).fastStart==="fragmented")throw new Error("Can't finalize individual chunks if 'fastStart' is set to 'fragmented'.");if(e.currentChunk){if(e.finalizedChunks.push(e.currentChunk),n(this,lt).push(e.currentChunk),(e.compactlyCodedChunkTable.length===0||$t(e.compactlyCodedChunkTable).samplesPerChunk!==e.currentChunk.samples.length)&&e.compactlyCodedChunkTable.push({firstChunk:e.finalizedChunks.length,samplesPerChunk:e.currentChunk.samples.length}),n(this,T).fastStart==="in-memory"){e.currentChunk.offset=0;return}e.currentChunk.offset=n(this,A).pos;for(let t of e.currentChunk.samples)n(this,A).write(t.data),t.data=null;W(this,dt,Et).call(this)}};Yt=new WeakSet;oa=function(e=!0){if(n(this,T).fastStart!=="fragmented")throw new Error("Can't finalize a fragment unless 'fastStart' is set to 'fragmented'.");let t=[n(this,fe),n(this,le)].filter(o=>o&&o.currentChunk);if(t.length===0)return;let i=Rn(this,aa)._++;if(i===1){let o=Wt(t,n(this,ot),!0);n(this,A).writeBox(o)}let a=n(this,A).pos,r=Ta(i,t);n(this,A).writeBox(r);{let o=Bi(!1),f=0;for(let c of t)for(let C of c.currentChunk.samples)f+=C.size;let d=n(this,A).measureBox(o)+f;d>=2**32&&(o.largeSize=!0,d=n(this,A).measureBox(o)+f),o.size=d,n(this,A).writeBox(o)}for(let o of t){o.currentChunk.offset=n(this,A).pos,o.currentChunk.moofOffset=a;for(let f of o.currentChunk.samples)n(this,A).write(f.data),f.data=null}let s=n(this,A).pos;n(this,A).seek(n(this,A).offsets.get(r));let l=Ta(i,t);n(this,A).writeBox(l),n(this,A).seek(s);for(let o of t)o.finalizedChunks.push(o.currentChunk),n(this,lt).push(o.currentChunk),o.currentChunk=null;e&&W(this,dt,Et).call(this)};dt=new WeakSet;Et=function(){n(this,A)instanceof ia&&n(this,A).flush()};Vt=new WeakSet;qi=function(){if(n(this,bt))throw new Error("Cannot add new video or audio chunks after the file has been finalized.")};async function Ns(e,t,i){const{width:a,height:r,fps:s}=i,l=new Us({target:new Ya,video:{codec:"avc",width:a,height:r},firstTimestampBehavior:"offset",fastStart:!1}),o=new VideoEncoder({output:(p,h)=>l.addVideoChunk(p,h),error:p=>console.error(p)});o.configure({codec:"avc1.42001f",width:a,height:r,bitrate:2e6,framerate:s});const f=typeof OffscreenCanvas<"u"?new OffscreenCanvas(a,r):document.createElement("canvas");f instanceof HTMLCanvasElement&&(f.width=a,f.height=r);const d=f.getContext("2d",{alpha:!1}),c=1e6/s;for(let p=0;p<e.length;p++){t(d,e[p]);const h=new VideoFrame(f,{timestamp:p*c});o.encode(h,{keyFrame:p%(s*2)===0}),h.close()}await o.flush(),l.finalize();const C=l.target.buffer,_=new Blob([C],{type:"video/mp4"}),y=URL.createObjectURL(_),k=document.createElement("a");k.href=y,k.download=`particle_simulation_${Date.now()}.mp4`,k.click(),URL.revokeObjectURL(y)}class js{images={};cache={};loadingPromises={};async loadTexture(t,i){if(this.images[t])return;if(this.loadingPromises[t])return this.loadingPromises[t];const a=new Promise((r,s)=>{const l=new Image;l.crossOrigin="Anonymous",l.src=i,l.onload=()=>{this.images[t]=l,delete this.loadingPromises[t],r()},l.onerror=o=>{delete this.loadingPromises[t],console.error(`Failed to load texture: ${t}`,o),s(o)}});return this.loadingPromises[t]=a,a}async loadTextures(t){const i=Object.entries(t).map(([a,r])=>this.loadTexture(a,r));await Promise.all(i)}getTintedTexture(t,i){const a=this.images[t];if(!a)return null;const r=`${t}-${i}`;if(this.cache[r])return this.cache[r];const s=a.naturalWidth,l=a.naturalHeight,o=typeof OffscreenCanvas<"u"?new OffscreenCanvas(s,l):document.createElement("canvas");o instanceof HTMLCanvasElement&&(o.width=s,o.height=l);const f=o.getContext("2d");return f.drawImage(a,0,0),f.globalCompositeOperation="source-in",f.fillStyle=i,f.fillRect(0,0,s,l),f.globalCompositeOperation="source-over",this.cache[r]=o,o}}const Ei=new js;var Vs=De('<div><b>Emitter Properties</b> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Position</span></span> <span><span class="align-middle">x:</span></span> <input type="number" class="number-input"/> <span class="pl-1.5"><span class="align-middle">y:</span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Emissions per second</span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Particles per emission</span></span> <input type="number" class="number-input"/> <span><span class="align-middle"></span></span> <input type="number" class="number-input"/></div> <b>Default particle parameters</b> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Radius</span></span> <input type="number" class="number-input"/> <span><span class="align-middle"></span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Direction</span></span> <input type="number" class="number-input"/> <span><span class="align-middle"></span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Speed</span></span> <input type="number" class="number-input"/> <span><span class="align-middle"></span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Lifespan</span></span> <input type="number" class="number-input"/> <span><span class="align-middle"></span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Color</span></span> <input type="color"/></div> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Texture</span></span> <select class="dropdown"><option>Default</option><option>Smoke</option><option>Dot</option><option>Circle (Test)</option><option>Energy</option></select></div> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Rotation</span></span> <input type="number" class="number-input"/> <span><span class="align-middle"></span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2 m-1"><span class="grow"><span class="align-middle">Blend Mode</span></span> <select class="dropdown"><option>Normal</option><option>Multiply</option><option>Screen</option><option>Darken</option><option>Lighten</option><option>Add</option></select></div> <b>Particle Lifetime Settings</b> <div class="m-1"><span>Opacity curve</span> <!></div> <div class="m-1"><span>Speed over time</span> <!></div></div>'),$s=De('<button class="btn"> </button>'),Hs=De('<div class="flex flex-col gap-2"><div class="flex flex-row gap-2"><span class="grow"><span class="align-middle">Width</span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2"><span class="grow"><span class="align-middle">Height</span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2"><span class="grow"><span class="align-middle">FPS</span></span> <input type="number" class="number-input"/></div> <div class="flex flex-row gap-2"><span class="grow"><span class="align-middle">Duration</span></span> <input type="number" class="number-input"/></div></div>'),qs=De('<div class="flex flex-col w-full h-full gap-5 p-5 box-border"><div class="flex flex-row gap-5"><span class="font-bold">Particle Playground</span> <button>Export</button> <button>Project Settings</button> <button>Save</button> <button>Load</button></div> <div class="grow flex flex-row gap-4 min-h-0"><div class="grow flex justify-center items-center"><!></div> <div class="w-100 overflow-y-scroll pr-3 scrollbar-dark"></div></div> <div class="flex flex-row gap-4"><button><span class="icon icon-20 icon-filled align-middle">skip_previous</span></button> <label><input type="checkbox" class="hidden"/> <span class="icon icon-20 icon-filled align-middle"><!></span></label> <button><span class="icon icon-20 icon-filled align-middle">skip_next</span></button> <span class="grow"><input type="range" class="w-full progress-bar align-middle"/></span></div></div> <!> <!>',1);function Qs(e,t){St(t,!0);let i={};(async()=>(i.smoke=(await At(async()=>{const{default:g}=await import("../chunks/ipISX4LT.js");return{default:g}},[],import.meta.url)).default,i.dot=(await At(async()=>{const{default:g}=await import("../chunks/zPuzMr1R.js");return{default:g}},[],import.meta.url)).default,i.circle_test=(await At(async()=>{const{default:g}=await import("../chunks/BJ6ERqVJ.js");return{default:g}},[],import.meta.url)).default,i.energy=(await At(async()=>{const{default:g}=await import("../chunks/GtoclbRN.js");return{default:g}},[],import.meta.url)).default))();let a=se(Dt([{shape:{type:"point",x:480,y:270},emissionRate:10,particlesPerEmission:{value:10,variability:10},particleParams:{radius:{value:10,variability:0},direction:{value:0,variability:360},rotation:{value:0,variability:0},speed:{value:200,variability:80},lifespan:{value:.8,variability:.5},color:"#ffffff",lifetimeSettings:{opacityCurve:new Float32Array(new Array(100).fill(0).map((g,v)=>1-v/100)),opacityCurvePoints:[{x:0,y:1,id:0},{x:1,y:0,id:1}],speedCurve:new Float32Array(new Array(100).fill(1)),speedCurvePoints:[{x:0,y:1,id:0},{x:1,y:1,id:1}],radiusCurve:new Float32Array(new Array(100).fill(1)),radiusCurvePoints:[{x:0,y:1,id:0},{x:1,y:1,id:1}]},texture:"default",blendMode:"source-over"}}])),r=se(Dt({width:960,height:540,fps:30,duration:10}));function s(g,v,H){let I={index:g,particles:[]};for(let P of u(a))if(g%Math.max(Math.floor(u(r).fps/P.emissionRate),1)===0){let q=P.particlesPerEmission.value+H.intInRange(-P.particlesPerEmission.variability,P.particlesPerEmission.variability);for(let Z=0;Z<q;Z++){let we={x:P.shape.x,y:P.shape.y,radius:P.particleParams.radius.value+H.inRange(-.5,.5)*P.particleParams.radius.variability,direction:P.particleParams.direction.value+H.inRange(-.5,.5)*P.particleParams.direction.variability,rotation:P.particleParams.rotation.value+H.inRange(-.5,.5)*P.particleParams.rotation.variability,speed:P.particleParams.speed.value+H.inRange(-.5,.5)*P.particleParams.speed.variability,lifespan:P.particleParams.lifespan.value+H.inRange(-.5,.5)*P.particleParams.lifespan.variability,health:1,color:P.particleParams.color,opacity:P.particleParams.lifetimeSettings.opacityCurve[0],lifetimeSettings:P.particleParams.lifetimeSettings,texture:P.particleParams.texture,blendMode:P.particleParams.blendMode};I.particles.push(we)}}for(let P of v.particles){let q=Object.assign({},P),Z=Math.max(0,Math.min(1,1-q.health));const we=Math.floor(Z*(P.lifetimeSettings.opacityCurve.length-1));let he=P.speed*P.lifetimeSettings.speedCurve[we];q.x+=he/u(r).fps*Math.cos(P.direction*Math.PI/180),q.y+=he/u(r).fps*Math.sin(P.direction*Math.PI/180),q.health-=1/(q.lifespan*u(r).fps),q.opacity=Math.max(0,Math.min(1,P.lifetimeSettings.opacityCurve[we])),q.health>0&&I.particles.push(q)}return I.particles=I.particles.filter(P=>P.health>0),I}let l=Dt([]);function o(){let g=new N(69);l[0]=s(0,{particles:[]},g);for(let v=1;v<u(r).duration*u(r).fps;v++)l[v]=s(v,l[v-1],g)}let f=se(0),d=se(!1);function c(){u(d)&&setTimeout(c,1e3/u(r).fps),V(f,(u(f)+1)%(u(r).duration*u(r).fps))}function C(g,v,H="black"){H==="transparent"?g.clearRect(0,0,u(r).width,u(r).height):(g.save(),g.fillStyle=H,g.fillRect(0,0,u(r).width,u(r).height),g.restore());for(let I of v.particles){if(g.save(),g.globalAlpha=I.opacity,g.globalCompositeOperation=I.blendMode,I.texture==="default")g.fillStyle=I.color,g.beginPath(),g.arc(I.x,I.y,I.radius,0,2*Math.PI),g.fill();else{const P=Ei.getTintedTexture(I.texture,I.color);g.translate(I.x,I.y),g.rotate((I.direction+I.rotation)*Math.PI/180),g.drawImage(P,-I.radius,-I.radius,I.radius*2,I.radius*2)}g.restore()}}let _=se(!1),y=se(!1);async function k(){if(!u(y)){V(y,!0);try{await Ns(l,C,u(r))}catch(g){console.error("Export failed",g),alert("Export failed. Please check console.")}finally{V(y,!1)}}}let p=se(!1);function h(){let g=Object.assign({},{emitters:u(a),videoSettings:u(r)});g.emitters.forEach((P,q)=>{P.particleParams.lifetimeSettings.opacityCurve=Array.from(P.particleParams.lifetimeSettings.opacityCurve),P.particleParams.lifetimeSettings.radiusCurve=Array.from(P.particleParams.lifetimeSettings.radiusCurve),P.particleParams.lifetimeSettings.speedCurve=Array.from(P.particleParams.lifetimeSettings.speedCurve)});const v=new Blob([JSON.stringify(g)],{type:"application/json"}),H=URL.createObjectURL(v),I=document.createElement("a");I.href=H,I.download=`particle_simulation_${Date.now()}.json`,I.click(),URL.revokeObjectURL(H)}function M(){const g=document.createElement("input");g.type="file",g.accept=".json",g.onchange=async v=>{const H=v.target.files?.[0],I=new FileReader;I.onload=async P=>{const q=JSON.parse(P.target.result);for(let Z of q.emitters)Z.particleParams.lifetimeSettings.opacityCurve=new Float32Array(Z.particleParams.lifetimeSettings.opacityCurve),Z.particleParams.lifetimeSettings.radiusCurve=new Float32Array(Z.particleParams.lifetimeSettings.radiusCurve),Z.particleParams.lifetimeSettings.speedCurve=new Float32Array(Z.particleParams.lifetimeSettings.speedCurve),Z.particleParams.texture!=="default"&&await Ei.loadTexture(Z.particleParams.texture,i[Z.particleParams.texture]);V(a,q.emitters,!0),V(r,q.videoSettings,!0),o()},I.readAsText(H)},g.click()}ka(async()=>{o()});var G=qs();Pi("keydown",Ba,g=>{document.activeElement?.tagName!=="INPUT"&&g.key===" "&&(u(d)?V(d,!1):(V(d,!0),c()))});var Y=ut(G),F=B(Y),K=w(B(F),2);K.__click=()=>{V(_,!0)};var re=w(K,2);re.__click=()=>{V(p,!0)};var R=w(re,2);R.__click=()=>{h()};var oe=w(R,2);oe.__click=()=>{M()},L(F);var ie=w(F,2),Ie=B(ie),be=B(Ie);Cn(be,{get width(){return u(r).width},get height(){return u(r).height},class:"w-full! h-full! object-contain",children:(g,v)=>{Sn(g,{render:({context:H})=>{l[u(f)]&&C(H,l[u(f)],"#000000")}})},$$slots:{default:!0}}),L(Ie);var z=w(Ie,2);Di(z,21,()=>u(a),Ri,(g,v,H)=>{var I=Vs(),P=w(B(I),2),q=w(B(P),4);ee(q),q.__change=o,x(q,"min",0);var Z=w(q,4);ee(Z),Z.__change=o,x(Z,"min",0),L(P);var we=w(P,2),he=w(B(we),2);ee(he),he.__change=o,x(he,"min",.5),x(he,"max",10),x(he,"step",.1),L(we);var Ze=w(we,2),Ce=w(B(Ze),2);ee(Ce),Ce.__change=o,x(Ce,"min",0),x(Ce,"max",100),x(Ce,"step",1);var de=w(Ce,4);ee(de),de.__change=o,x(de,"min",0),x(de,"max",100),x(de,"step",1),L(Ze);var Jt=w(Ze,4),We=w(B(Jt),2);ee(We),We.__change=o,x(We,"min",0),x(We,"max",100),x(We,"step",1);var Qe=w(We,4);ee(Qe),Qe.__change=o,x(Qe,"min",0),x(Qe,"max",100),x(Qe,"step",1),L(Jt);var Zt=w(Jt,2),Ue=w(B(Zt),2);ee(Ue),Ue.__change=o,x(Ue,"min",0),x(Ue,"max",360),x(Ue,"step",1);var et=w(Ue,4);ee(et),et.__change=o,x(et,"min",0),x(et,"max",360),x(et,"step",1),L(Zt);var Qt=w(Zt,2),Ne=w(B(Qt),2);ee(Ne),Ne.__change=o,x(Ne,"min",0),x(Ne,"max",1e3),x(Ne,"step",1);var tt=w(Ne,4);ee(tt),tt.__change=o,x(tt,"min",0),x(tt,"max",1e3),x(tt,"step",1),L(Qt);var ei=w(Qt,2),je=w(B(ei),2);ee(je),je.__change=o,x(je,"min",0),x(je,"max",10),x(je,"step",.1);var it=w(je,4);ee(it),it.__change=o,x(it,"min",0),x(it,"max",10),x(it,"step",.1),L(ei);var ti=w(ei,2),ii=w(B(ti),2);ee(ii),ii.__change=o,L(ti);var ai=w(ti,2),Pt=w(B(ai),2);Pt.__change=async()=>{u(v).particleParams.texture!=="default"&&await Ei.loadTexture(u(v).particleParams.texture,i[u(v).particleParams.texture]),o()};var ri=B(Pt);ri.value=ri.__value="default";var ni=w(ri);ni.value=ni.__value="smoke";var si=w(ni);si.value=si.__value="dot";var oi=w(si);oi.value=oi.__value="circle_test";var la=w(oi);la.value=la.__value="energy",L(Pt),L(ai);var li=w(ai,2),Ve=w(B(li),2);ee(Ve),Ve.__change=o,x(Ve,"min",0),x(Ve,"max",360),x(Ve,"step",1);var at=w(Ve,4);ee(at),at.__change=o,x(at,"min",0),x(at,"max",360),x(at,"step",1),L(li);var ui=w(li,2),Mt=w(B(ui),2);Mt.__change=o;var fi=B(Mt);fi.value=fi.__value="source-over";var di=w(fi);di.value=di.__value="multiply";var ci=w(di);ci.value=ci.__value="screen";var hi=w(ci);hi.value=hi.__value="darken";var pi=w(hi);pi.value=pi.__value="lighten";var ua=w(pi);ua.value=ua.__value="lighter",L(Mt),L(ui);var mi=w(ui,4),sr=w(B(mi),2);xa(sr,{onchange:o,get value(){return u(v).particleParams.lifetimeSettings.opacityCurve},set value(O){u(v).particleParams.lifetimeSettings.opacityCurve=O},get points(){return u(v).particleParams.lifetimeSettings.opacityCurvePoints},set points(O){u(v).particleParams.lifetimeSettings.opacityCurvePoints=O}}),L(mi);var fa=w(mi,2),or=w(B(fa),2);xa(or,{onchange:o,get value(){return u(v).particleParams.lifetimeSettings.speedCurve},set value(O){u(v).particleParams.lifetimeSettings.speedCurve=O},get points(){return u(v).particleParams.lifetimeSettings.speedCurvePoints},set points(O){u(v).particleParams.lifetimeSettings.speedCurvePoints=O}}),L(fa),L(I),ze(()=>{x(q,"max",u(r).width),x(Z,"max",u(r).height)}),te(q,()=>u(v).shape.x,O=>u(v).shape.x=O),te(Z,()=>u(v).shape.y,O=>u(v).shape.y=O),te(he,()=>u(v).emissionRate,O=>u(v).emissionRate=O),te(Ce,()=>u(v).particlesPerEmission.value,O=>u(v).particlesPerEmission.value=O),te(de,()=>u(v).particlesPerEmission.variability,O=>u(v).particlesPerEmission.variability=O),te(We,()=>u(v).particleParams.radius.value,O=>u(v).particleParams.radius.value=O),te(Qe,()=>u(v).particleParams.radius.variability,O=>u(v).particleParams.radius.variability=O),te(Ue,()=>u(v).particleParams.direction.value,O=>u(v).particleParams.direction.value=O),te(et,()=>u(v).particleParams.direction.variability,O=>u(v).particleParams.direction.variability=O),te(Ne,()=>u(v).particleParams.speed.value,O=>u(v).particleParams.speed.value=O),te(tt,()=>u(v).particleParams.speed.variability,O=>u(v).particleParams.speed.variability=O),te(je,()=>u(v).particleParams.lifespan.value,O=>u(v).particleParams.lifespan.value=O),te(it,()=>u(v).particleParams.lifespan.variability,O=>u(v).particleParams.lifespan.variability=O),te(ii,()=>u(v).particleParams.color,O=>u(v).particleParams.color=O),va(Pt,()=>u(v).particleParams.texture,O=>u(v).particleParams.texture=O),te(Ve,()=>u(v).particleParams.rotation.value,O=>u(v).particleParams.rotation.value=O),te(at,()=>u(v).particleParams.rotation.variability,O=>u(v).particleParams.rotation.variability=O),va(Mt,()=>u(v).particleParams.blendMode,O=>u(v).particleParams.blendMode=O),ce(g,I)}),L(z),L(ie);var m=w(ie,2),S=B(m);S.__click=()=>{Ii(f,-1),u(f)<0&&V(f,u(r).duration*u(r).fps-1)};var E=w(S,2),U=B(E);ee(U),U.__change=c;var J=w(U,2),Q=B(J);{var _e=g=>{var v=da("pause");ce(g,v)},Fe=g=>{var v=da("play_arrow");ce(g,v)};Xi(Q,g=>{u(d)?g(_e):g(Fe,!1)})}L(J),L(E);var Le=w(E,2);Le.__click=()=>{Ii(f),u(f)>=u(r).duration*u(r).fps&&V(f,0)};var Pe=w(Le,2),Je=B(Pe);ee(Je),x(Je,"min",0),L(Pe),L(m),L(Y);var kt=w(Y,2);Sa(kt,{title:"Export",get open(){return u(_)},set open(g){V(_,g,!0)},children:(g,v)=>{var H=$s();H.__click=k;var I=B(H,!0);L(H),ze(()=>{H.disabled=u(y),Wa(I,u(y)?"Rendering...":"Export MP4")}),ce(g,H)},$$slots:{default:!0}});var Be=w(kt,2);Sa(Be,{title:"Project Settings",get open(){return u(p)},set open(g){V(p,g,!0)},children:(g,v)=>{var H=Hs(),I=B(H),P=w(B(I),2);ee(P),P.__change=o,L(I);var q=w(I,2),Z=w(B(q),2);ee(Z),Z.__change=o,L(q);var we=w(q,2),he=w(B(we),2);ee(he),he.__change=o,L(we);var Ze=w(we,2),Ce=w(B(Ze),2);ee(Ce),Ce.__change=o,L(Ze),L(H),te(P,()=>u(r).width,de=>u(r).width=de),te(Z,()=>u(r).height,de=>u(r).height=de),te(he,()=>u(r).fps,de=>u(r).fps=de),te(Ce,()=>u(r).duration,de=>u(r).duration=de),ce(g,H)},$$slots:{default:!0}}),ze(()=>x(Je,"max",u(r).duration*u(r).fps-1)),Gr(U,()=>u(d),g=>V(d,g)),te(Je,()=>u(f),g=>V(f,g)),ce(e,G),Tt()}Gi(["click","change"]);export{Qs as component};
